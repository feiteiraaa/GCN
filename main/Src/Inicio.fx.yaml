Inicio As screen:
    OnVisible: =

    Label1 As label:
        Size: =15
        Text: ="Bem vindo, " & User().FullName & " (" & currentUser & ")"
        Width: =610
        X: =359
        Y: =35
        ZIndex: =7

    LeftSectionComponent_1 As LeftSectionComponent:
        ZIndex: =8

    KPIs As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =9

        KPI_Total As KPI:
            KPIInfo: ="Total de Processos de Atividades"
            KPIName: ="Total"
            KPINumber: |-
                =CountRows(
                    Filter(
                        Atividades,
                        currentUser in ThisRecord.'Unidade Orgânica'
                    )
                )
            X: =359
            Y: =100

        KPI_EmPreenchimento As KPI:
            KPIInfo: ="Processos de Atvividades em Preenchimento"
            KPIName: ="Em Preenchimento"
            KPINumber: |-
                =CountRows(
                    Filter(
                        Atividades,
                        currentUser in ThisRecord.'Unidade Orgânica'
                        And
                        Lower(Trim(ThisRecord.Estado)) = Lower(Trim("Em Preenchimento"))
                    )
                )
            X: =527
            Y: =100
            ZIndex: =2

        KPI_EmValidação As KPI:
            KPIInfo: ="Processos de Atividades em Validação"
            KPIName: ="Em Validação"
            KPINumber: |-
                =CountRows(
                    Filter(
                        Atividades,
                        currentUser in ThisRecord.'Unidade Orgânica'
                        And
                        Lower(Trim(ThisRecord.Estado)) = Lower(Trim("Em Validação"))
                    )
                )
            X: =696
            Y: =100
            ZIndex: =3

        KPI_Aprovados As KPI:
            KPIInfo: ="Processos de Atividade Aprovados"
            KPIName: ="Aprovados"
            KPINumber: |-
                =CountRows(
                    Filter(
                        Atividades,
                        currentUser in ThisRecord.'Unidade Orgânica'
                        And
                        Lower(Trim(ThisRecord.Estado)) = Lower(Trim("Aprovados"))
                    )
                )
            X: =864
            Y: =100
            ZIndex: =4

        KPI_Rejeitados As KPI:
            KPIInfo: ="Processos de Atividade Rejeitados"
            KPIName: ="Rejeitados"
            KPINumber: |-
                =CountRows(
                    Filter(
                        Atividades,
                        currentUser in ThisRecord.'Unidade Orgânica'
                        And
                        Lower(Trim(ThisRecord.Estado)) = Lower(Trim("Rejeitados"))
                    )
                )
            X: =1031
            Y: =100
            ZIndex: =5

        KPI_EmRevisao As KPI:
            KPIInfo: ="Processos de Atividade em Revisão"
            KPIName: ="Em Revisão"
            KPINumber: |-
                =CountRows(
                    Filter(
                        Atividades,
                        currentUser in ThisRecord.'Unidade Orgânica'
                        And
                        Lower(Trim(ThisRecord.Estado)) = Lower(Trim("Em Revisão"))
                    )
                )
            X: =1196
            Y: =100
            ZIndex: =6

    TextCanvas1 As Text:
        DisplayMode: =DisplayMode.View
        Height: =32
        Text: ="v" & appVersion
        Width: =58
        X: =1308
        Y: =20
        ZIndex: =10

    Icon1 As icon.Information:
        Color: =Color.Black
        Height: =25
        Icon: =Icon.Information
        Width: =25
        X: =1278
        Y: =23
        ZIndex: =11

    Label1_5 As label:
        Text: ="Histórico de estado das atividades"
        Width: =337
        X: =359
        Y: =294
        ZIndex: =21

    "'Gallery Data_2' As gallery.variableTemplateHeightGallery":
        DelayItemLoading: =true
        DisplayMode: =DisplayMode.View
        Fill: =Color.White
        Height: =333
        Items: |-
            =With(
                {
                    records:
                    If(
                        currentUser = "DRI",
                        'Histórico de aprovações',
                        Filter(
                            'Histórico de aprovações',
                            ThisRecord.'ID Atividade'.'Unidade Orgânica' = currentUser
                        )
                    )        
                },
                ForAll(
                    Sequence(CountRows(records)),
                    Patch(
                        Last(
                            FirstN(
                                SortByColumns(
                                    records,
                                    "createdon",
                                    SortOrder.Descending
                                ),
                                Value
                            )
                        ),
                        {rowNumber: Value}
                    )
                )
            )
        Layout: =Layout.Vertical
        LoadingSpinner: =LoadingSpinner.Data
        OnSelect: =
        ShowScrollbar: =false
        TemplateFill: |-
            =If(
                Mod(ThisItem.rowNumber, 2) = 0,
                Color.LightSlateGray,
                Color.White
            )
        TemplatePadding: =0
        TemplateSize: =75
        Width: =Principal_2.Width
        X: =356
        Y: =392
        ZIndex: =30

        Rectangle2_2 As rectangle:
            Fill: |-
                =Switch(
                    Trim(Lower(ThisItem.Estado)),
                    
                    Trim(Lower("Em preenchimento")),
                    Color.Blue,
                    
                    Trim(Lower("Em validação")),
                    Color.Yellow,
                
                    Trim(Lower("Aprovado")),
                    Color.Green,
                
                    Trim(Lower("Rejeitado")),
                    Color.Red,
                
                    Trim(Lower("Em revisão pela U.O.")),
                    Color.DarkOrange,
                
                    Trim(Lower("Em revalidação")),
                    Color.Yellow
                
                )
            Height: =75
            OnSelect: =Select(Parent)
            Width: =7
            ZIndex: =1

        "'U.O._2' As label":
            Align: =Align.Center
            Color: |-
                =If(
                    Mod(ThisItem.rowNumber, 2) = 0,
                    Color.White,
                    Color.DarkSlateGray
                )
            Height: =Rectangle2_2.Height
            OnSelect: |-
                =Select(Parent);
                Navigate('Atividade Form Screen',ScreenTransition.None, {formMode: FormMode.View, Criticidade: 0});
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Text: =ThisItem.Estado
            Width: |-
                =(
                    Principal_2.Width - ('U.O. Header Split_2'.Width * 4)
                ) / 4
            Y: =Rectangle2_2.Y
            ZIndex: =2

        "'U.O. Split_2' As rectangle":
            Fill: =Color.LightGray
            Height: =Rectangle2_2.Height
            OnSelect: =
            Width: =2
            X: ='U.O._2'.X + 'U.O._2'.Width
            Y: =Rectangle2_2.Y
            ZIndex: =3

        Atividade_2 As label:
            Align: =Align.Center
            Color: |-
                =If(
                    Mod(ThisItem.rowNumber, 2) = 0,
                    Color.White,
                    Color.DarkSlateGray
                )
            Height: =Rectangle2_2.Height
            OnSelect: |-
                =Select(Parent);
                Navigate('Atividade Form Screen',ScreenTransition.None, {formMode: FormMode.View, Criticidade: 0});
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Text: =ThisItem.'ID Atividade'.Atividade
            Width: |-
                =(
                    Principal_2.Width - ('U.O. Header Split_2'.Width * 4)
                ) / 4
            X: ='U.O. Split_2'.X + 'U.O. Split_2'.Width
            Y: =Rectangle2_2.Y
            ZIndex: =4

        "'Atividade Split_2' As rectangle":
            Fill: =Color.LightGray
            Height: =Rectangle2_2.Height
            OnSelect: =Atividade_2.X + Atividade_2.Width
            Width: =2
            X: =Atividade_2.X + Atividade_2.Width
            Y: =Rectangle2_2.Y
            ZIndex: =5

        Descricao_2 As label:
            Align: =Align.Center
            Color: |-
                =If(
                    Mod(ThisItem.rowNumber, 2) = 0,
                    Color.White,
                    Color.DarkSlateGray
                )
            Height: =Rectangle2_2.Height
            OnSelect: |-
                =Select(Parent);
                Navigate('Atividade Form Screen',ScreenTransition.None, {formMode: FormMode.View, Criticidade: 0});
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Text: =ThisItem.'ID Atividade'.'Unidade Orgânica'
            Width: |-
                =(
                    Principal_2.Width - ('U.O. Header Split_2'.Width * 4)
                ) / 4
            X: ='Atividade Split_2'.X + 'Atividade Split_2'.Width
            Y: =Rectangle2_2.Y
            ZIndex: =6

        "'Descricao Split_2' As rectangle":
            Fill: =Color.LightGray
            Height: =Rectangle2_2.Height
            OnSelect: =
            Width: =2
            X: =Descricao_2.X + Descricao_2.Width
            Y: =Rectangle2_2.Y
            ZIndex: =7

        "'Tipo Processo_2' As label":
            Align: =Align.Center
            Color: |-
                =If(
                    Mod(ThisItem.rowNumber, 2) = 0,
                    Color.White,
                    Color.DarkSlateGray
                )
            Height: =Rectangle2_2.Height
            OnSelect: |-
                =Select(Parent);
                Navigate('Atividade Form Screen',ScreenTransition.None, {formMode: FormMode.View, Criticidade: 0});
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Text: =First(ThisItem.'ID Atividade'.RTOS).Classificação
            Width: |-
                =(
                    Principal_2.Width - ('U.O. Header Split_2'.Width * 4)
                ) / 4
            X: ='Descricao Split_2'.X + 'Descricao Split_2'.Width
            Y: =Rectangle2_2.Y
            ZIndex: =8

    "'Galery Headers_2' As group":
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =31

        Principal_2 As rectangle:
            Fill: =cores.cinzento
            Height: =63
            OnSelect: =
            TabIndex: =0
            Width: =990
            X: =356
            Y: =334
            ZIndex: =22

        "'U.O. Header_2' As label":
            Align: =Align.Center
            Color: =Color.LightGray
            Height: =Principal_2.Height
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            TabIndex: =0
            Text: ="Estado"
            Width: |-
                =(
                    Principal_2.Width - ('U.O. Header Split_2'.Width * 4)
                ) / 4
            X: =357
            Y: =329
            ZIndex: =23

        "'U.O. Header Split_2' As rectangle":
            Fill: =Color.LightGray
            Height: =Principal_2.Height
            OnSelect: =
            TabIndex: =0
            Width: =2
            X: =601
            Y: =334
            ZIndex: =24

        "'Atividade Header_2' As label":
            Align: =Align.Center
            Color: =Color.LightGray
            Height: =Principal_2.Height
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            TabIndex: =0
            Text: ="Atividade"
            Width: |-
                =(
                    Principal_2.Width - ('U.O. Header Split_2'.Width * 4)
                ) / 4
            X: =603
            Y: =329
            ZIndex: =25

        "'Atividade Header Split_2' As rectangle":
            Fill: =Color.LightGray
            Height: =Principal_2.Height
            OnSelect: =
            TabIndex: =0
            Width: =2
            X: =849
            Y: =334
            ZIndex: =26

        "'Descricao Header_2' As label":
            Align: =Align.Center
            Color: =Color.LightGray
            Height: =Principal_2.Height
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            TabIndex: =0
            Text: ="Unidade Orgânica"
            Width: |-
                =(
                    Principal_2.Width - ('U.O. Header Split_2'.Width * 4)
                ) / 4
            X: =847
            Y: =329
            ZIndex: =27

        "'Descricao Header Split_2' As rectangle":
            Fill: =Color.LightGray
            Height: =Principal_2.Height
            OnSelect: =
            TabIndex: =0
            Width: =2
            X: =1096
            Y: =334
            ZIndex: =28

        "'Tipo Processo Header_2' As label":
            Align: =Align.Center
            Color: =Color.LightGray
            Height: =Principal_2.Height
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            TabIndex: =0
            Text: ="Classificação de RTO"
            Width: |-
                =(
                    Principal_2.Width - ('U.O. Header Split_2'.Width * 4)
                ) / 4
            X: =1100
            Y: =329
            ZIndex: =29

