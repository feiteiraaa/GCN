"'Atividade Form Screen' As screen":
    OnVisible: |-
        =UpdateContext({
            ModalForm: {visible: false, text: "Deseja submeter os dados da Atividade?"}
        });
        
        UpdateContext({
            ApproveForm: { visible: false, texto: ""}
        });
        
        If(
            formMode <> FormMode.New,
        
            UpdateContext({
                AtividadeRecord: LookUp(
                    Atividades,
                    ThisRecord.ID = 'Gallery Data'.Selected.ID
                )
            });
            UpdateIf(
                AtividadeFormMenu,
                ThisRecord.modo = DisplayMode.Disabled,
                {modo: DisplayMode.Edit}
            );
            UpdateIf(
                AtividadeFormMenu,
                Lower(Trim(ThisRecord.titulo)) = Lower(Trim("Fatores de Criticidade")),
                {estado : "feito"}
            );
            // dados dos Recursos/Pessoas
        Clear(collectRecursos);
        
            ForAll(
                Filter(
                    Pessoas,
                    ThisRecord.'ID Atividade'.ID = Text('Gallery Data'.Selected.ID)
                ),
                Collect(
                    collectRecursos,
                    {
                        row: Last(collectRecursos).row + 1,
                        ID: ThisRecord.ID,
                        Colaborador: ThisRecord.'Colaborador Crítico',
                        Duracao: ThisRecord.Duração,
                        NumEmpregado: ThisRecord.'Nº Empregado',
                        Teletrabalho: ThisRecord.Teletrabalho,
                        Tipo: ThisRecord.Tipo.Tipo,
                        Observações: ThisRecord.Observações
                    }
                )
            );
            // dados dos Equipamentos
        
        Clear(collectEquipamentos);
            ForAll(
                Filter(
                    'Equipamentos de Escritório',
                    ThisRecord.'ID Atividade'.ID = Text('Gallery Data'.Selected.ID)
                ),
                Collect(
                    collectEquipamentos,
                    {
                        row: Last(collectEquipamentos).row + 1,
                        ID: ThisRecord.ID,
                        Equipamento: ThisRecord.Equipamento,
                        Duracao: ThisRecord.Duração,
                        Observações: ThisRecord.Observações
                    }
                )
            );
            // dados dos Sistemas/Aplicações
        
        Clear(collectSistemas);
        
            ForAll(
                Filter(
                    Sistemas,
                    ThisRecord.'ID Atividade'.ID = Text('Gallery Data'.Selected.ID)
                ),
                Collect(
                    collectSistemas,
                    {
                        row: Last(collectSistemas).row + 1,
                        ID: ThisRecord.ID,
                        Sistema: ThisRecord.'Sistemas/Aplicações',
                        Duracao: ThisRecord.Duração,
                        Descricao: ThisRecord.Descrição,
                        Observações: ThisRecord.Observações
                    }
                )
            );
            // dados das Dependências
        Clear(collectDependencias);
        
            ForAll(
                Filter(
                    Dependências,
                    ThisRecord.'ID Atividade'.ID = Text('Gallery Data'.Selected.ID)
                ),
                Collect(
                    collectDependencias,
                    {
                        row: Last(collectDependencias).row + 1,
                        ID: ThisRecord.ID,
                        Entidade: ThisRecord.Entidades,
                        Tipo: ThisRecord.'Tipo de Dependência',
                        Importancia: ThisRecord.Importância,
                        Informacao: ThisRecord.'Informação de Suporte',
                        Unidade: ThisRecord.'Unidade Orgânica',
                        Observações: ThisRecord.Observações
                    }
                )
            )
        )

    Label7_1 As label:
        Align: =Align.Center
        Color: =cores.cinzento
        Text: ="Adição de " & 'Passos do Registo de Atividade'.Selected.titulo & " apenas disponível quando Fatores de Criticidade com valor igual a 4."
        Visible: |-
            =Switch(
                Trim(Lower('Passos do Registo de Atividade'.Selected.titulo)),
                
                Trim(Lower("Caracterização dos Recursos")),
                If(CountRows(collectRecursos) = 0, true, false),
            
                Trim(Lower("Caracterização dos Equipamentos")),
                If(CountRows(collectEquipamentos) = 0, true, false),
            
                Trim(Lower("Caracterização dos Sistemas")),
                If(CountRows(collectSistemas) = 0, true, false),
            
                Trim(Lower("Dependências")),
                If(CountRows(collectDependencias) = 0, true, false)
            )
            And
            If(formMode = FormMode.New, true, false)
            And
            If(
                Value('4Horas'.Text) =4 Or
                Value('24Horas'.Text)= 4 Or
                Value('48Horas'.Text) = 4 Or
                Value('1Semana'.Text) = 4 Or
                Value('2Semanas'.Text) = 4 Or
                Value('1Mes'.Text) = 4, false, true
            )
        Width: =980
        X: =360
        Y: =220
        ZIndex: =1

    LeftSectionComponent_4 As LeftSectionComponent:
        ZIndex: =2

    "'Caracterizacao do Processo' As form":
        DataSource: =Atividades
        DefaultMode: |-
            =Switch(
                formMode,
                0,
                FormMode.Edit,
                1,
                FormMode.New,
                FormMode.View
            )
        Height: =385
        Item: |-
            =If(
                formMode = FormMode.New,
                Blank(),
                LookUp(
                    Atividades,
                    ThisRecord.ID = 'Gallery Data'.Selected.ID
                )
            )
        Visible: =Trim(Lower('Passos do Registo de Atividade'.Selected.titulo)) = Trim(Lower("Caracterização do Processo"))
        Width: =990
        X: =360
        Y: =175
        ZIndex: =3

        "'Tipo de Processo_DataCard1' As typedDataCard.comboBoxEditCard":
            BorderStyle: =BorderStyle.Solid
            DataField: ="uipp_TipodeProcesso"
            Default: =ThisItem.'Tipo de Processo'
            DisplayMode: =Parent.DisplayMode
            DisplayName: =DataSourceInfo([@Atividades],DataSourceInfo.DisplayName,"uipp_TipodeProcesso")
            Fill: =RGBA(0, 0, 0, 0)
            Height: =110
            Required: =true
            Update: =DataCardValue11.Selected
            Width: =329
            X: =0
            Y: =0
            ZIndex: =1

            DataCardKey12 As label:
                AutoHeight: =true
                Color: =cores.cinzento
                FontWeight: =FontWeight.Bold
                Height: =34
                Text: =Parent.DisplayName
                Width: =294
                Wrap: =false
                X: =30
                Y: =10
                ZIndex: =1

            DataCardValue11 As combobox:
                BorderColor: =If(IsBlank(Parent.Error), cores.cinzento, Color.Red)
                ChevronBackground: =cores.amareloMontepio
                ChevronHoverBackground: =cores.amareloMontepio
                DefaultSelectedItems: =Parent.Default
                DisplayFields: =["uipp_tipodeprocesso"]
                DisplayMode: =Parent.DisplayMode
                HoverBorderColor: =cores.cinzento
                HoverFill: =cores.amareloMontepio
                InputTextPlaceholder: ="Tipo de Processo"
                Items: =Choices([@Atividades].'Tipo de Processo')
                OnChange: |-
                    =If(
                        !IsBlank(DataCardValue11.Selected) And !IsBlank(DataCardValue8.Selected) And !IsBlank(DataCardValue10.Selected) And !IsBlank(DataCardValue3.Text),
                        Patch(
                            AtividadeFormMenu,
                            LookUp(
                                AtividadeFormMenu,
                                Trim(Lower(ThisRecord.titulo)) = Trim(Lower("Caracterização do Processo"))
                            ),
                            {
                                estado: "feito"
                            }
                        )
                    )
                PaddingLeft: |-
                    =//If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                    5
                PressedFill: =cores.amareloMontepio
                SearchFields: =["uipp_tipodeprocesso"]
                SearchItems: =Search(Choices([@Atividades].'Tipo de Processo'),DataCardValue11.SearchText,"uipp_tipodeprocesso")
                SelectionFill: =cores.amareloMontepio
                SelectMultiple: =false
                Tooltip: =Parent.DisplayName
                Width: =280
                X: =30
                Y: =44
                ZIndex: =2

            ErrorMessage10 As label:
                AutoHeight: =true
                Height: =10
                Live: =Live.Assertive
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =Parent.Error
                Visible: =Parent.DisplayMode=DisplayMode.Edit
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardValue11.Y + DataCardValue11.Height
                ZIndex: =3

            StarVisible10 As label:
                Align: =Align.Center
                Color: =Color.Red
                Height: =DataCardKey12.Height
                Text: ="*"
                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                Width: =30
                Wrap: =false
                Y: =DataCardKey12.Y
                ZIndex: =4

        "'Macro Processo_DataCard1' As typedDataCard.comboBoxEditCard":
            BorderStyle: =BorderStyle.Solid
            DataField: ="uipp_MacroProcesso"
            Default: =ThisItem.'Macro Processo'
            DisplayMode: =Parent.DisplayMode
            DisplayName: =DataSourceInfo([@Atividades],DataSourceInfo.DisplayName,"uipp_MacroProcesso")
            Fill: =RGBA(0, 0, 0, 0)
            Height: =50
            Required: =true
            Update: =DataCardValue8.Selected
            Visible: =true
            Width: =329
            X: =1
            Y: =0
            ZIndex: =1

            DataCardKey9 As label:
                AutoHeight: =true
                Color: =cores.cinzento
                FontWeight: =FontWeight.Bold
                Height: =34
                Text: =Parent.DisplayName
                Width: =Parent.Width - 60
                Wrap: =false
                X: =30
                Y: =10
                ZIndex: =1

            DataCardValue8 As combobox:
                BorderColor: =If(IsBlank(Parent.Error), cores.cinzento, Color.Red)
                ChevronBackground: =cores.amareloMontepio
                ChevronHoverBackground: =cores.amareloMontepio
                DefaultSelectedItems: =Parent.Default
                DisplayFields: =["uipp_macroprocesso"]
                DisplayMode: =Parent.DisplayMode
                HoverBorderColor: =cores.cinzento
                HoverFill: =cores.amareloMontepio
                InputTextPlaceholder: ="Macro Processo"
                Items: =Choices([@Atividades].'Macro Processo')
                OnChange: |-
                    =If(
                        !IsBlank(DataCardValue11.Selected) And !IsBlank(DataCardValue8.Selected) And !IsBlank(DataCardValue10.Selected) And !IsBlank(DataCardValue3.Text),
                        Patch(
                            AtividadeFormMenu,
                            LookUp(
                                AtividadeFormMenu,
                                Trim(Lower(ThisRecord.titulo)) = Trim(Lower("Caracterização do Processo"))
                            ),
                            {
                                estado: "feito"
                            }
                        )
                    )
                PressedFill: =cores.amareloMontepio
                SearchFields: =["uipp_macroprocesso"]
                SearchItems: =Search(Choices([@Atividades].'Macro Processo'),DataCardValue8.SearchText,"uipp_macroprocesso")
                SelectionFill: =cores.amareloMontepio
                SelectMultiple: =false
                Tooltip: =Parent.DisplayName
                Width: =Parent.Width - 60
                X: =30
                Y: =44
                ZIndex: =2

            ErrorMessage7 As label:
                AutoHeight: =true
                Height: =10
                Live: =Live.Assertive
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =Parent.Error
                Visible: =Parent.DisplayMode=DisplayMode.Edit
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardValue8.Y + DataCardValue8.Height
                ZIndex: =3

            StarVisible7 As label:
                Align: =Align.Center
                Color: =Color.Red
                Height: =DataCardKey9.Height
                Text: ="*"
                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                Width: =30
                Wrap: =false
                Y: =DataCardKey9.Y
                ZIndex: =4

        Processo_DataCard1 As typedDataCard.comboBoxEditCard:
            BorderStyle: =BorderStyle.Solid
            DataField: ="uipp_Processo"
            Default: =ThisItem.Processo
            DisplayMode: =Parent.DisplayMode
            DisplayName: =DataSourceInfo([@Atividades],DataSourceInfo.DisplayName,"uipp_Processo")
            Fill: =RGBA(0, 0, 0, 0)
            Height: =50
            Required: =true
            Update: =DataCardValue10.Selected
            Width: =329
            X: =2
            Y: =0
            ZIndex: =1

            DataCardKey11 As label:
                AutoHeight: =true
                Color: =cores.cinzento
                FontWeight: =FontWeight.Bold
                Height: =34
                Text: =Parent.DisplayName
                Width: =Parent.Width - 60
                Wrap: =false
                X: =30
                Y: =10
                ZIndex: =1

            DataCardValue10 As combobox:
                BorderColor: =If(IsBlank(Parent.Error), cores.cinzento, Color.Red)
                ChevronBackground: =cores.amareloMontepio
                ChevronHoverBackground: =cores.amareloMontepio
                DefaultSelectedItems: =Parent.Default
                DisplayFields: =["uipp_processo"]
                DisplayMode: =Parent.DisplayMode
                HoverBorderColor: =cores.cinzento
                HoverFill: =cores.amareloMontepio
                InputTextPlaceholder: ="Processo"
                Items: =Choices([@Atividades].Processo)
                OnChange: |-
                    =If(
                        !IsBlank(DataCardValue11.Selected) And !IsBlank(DataCardValue8.Selected) And !IsBlank(DataCardValue10.Selected) And !IsBlank(DataCardValue3.Text),
                        Patch(
                            AtividadeFormMenu,
                            LookUp(
                                AtividadeFormMenu,
                                Trim(Lower(ThisRecord.titulo)) = Trim(Lower("Caracterização do Processo"))
                            ),
                            {
                                estado: "feito"
                            }
                        )
                    )
                PressedFill: =cores.amareloMontepio
                SearchFields: =["uipp_processo"]
                SearchItems: =Search(Choices([@Atividades].Processo),DataCardValue10.SearchText,"uipp_processo")
                SelectionFill: =cores.amareloMontepio
                SelectMultiple: =false
                Tooltip: =Parent.DisplayName
                Width: =Parent.Width - 60
                X: =30
                Y: =44
                ZIndex: =2

            ErrorMessage9 As label:
                AutoHeight: =true
                Height: =10
                Live: =Live.Assertive
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =Parent.Error
                Visible: =Parent.DisplayMode=DisplayMode.Edit
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardValue10.Y + DataCardValue10.Height
                ZIndex: =3

            StarVisible9 As label:
                Align: =Align.Center
                Color: =Color.Red
                Height: =DataCardKey11.Height
                Text: ="*"
                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                Width: =30
                Wrap: =false
                Y: =DataCardKey11.Y
                ZIndex: =4

        Atividade_DataCard1 As typedDataCard.textualMultiLineEditCard:
            BorderStyle: =BorderStyle.Solid
            DataField: ="uipp_atividade"
            Default: =ThisItem.Atividade
            DisplayMode: =Parent.DisplayMode
            DisplayName: =DataSourceInfo([@Atividades],DataSourceInfo.DisplayName,"uipp_atividade")
            Fill: =RGBA(0, 0, 0, 0)
            Height: =50
            Required: =true
            Update: =DataCardValue3.Text
            Width: =660
            WidthFit: =false
            X: =0
            Y: =1
            ZIndex: =1

            DataCardKey3 As label:
                AutoHeight: =true
                Color: =cores.cinzento
                FontWeight: =FontWeight.Bold
                Height: =34
                Text: =Parent.DisplayName
                Width: =Parent.Width - 60
                Wrap: =false
                X: =30
                Y: =10
                ZIndex: =1

            DataCardValue3 As text:
                BorderColor: =If(IsBlank(Parent.Error), cores.cinzento, Color.Red)
                Default: =Parent.Default
                DelayOutput: =true
                DisplayMode: =Parent.DisplayMode
                Height: =80
                HintText: ="Atividade"
                HoverBorderColor: =cores.cinzento
                HoverFill: =RGBA(255, 255, 255, 1)
                Mode: =TextMode.MultiLine
                OnChange: |-
                    =If(
                        !IsBlank(DataCardValue11.Selected) And !IsBlank(DataCardValue8.Selected) And !IsBlank(DataCardValue10.Selected) And !IsBlank(DataCardValue3.Text),
                        Patch(
                            AtividadeFormMenu,
                            LookUp(
                                AtividadeFormMenu,
                                Trim(Lower(ThisRecord.titulo)) = Trim(Lower("Caracterização do Processo"))
                            ),
                            {
                                estado: "feito"
                            }
                        )
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Tooltip: =Parent.DisplayName
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardKey3.Y + DataCardKey3.Height + 5
                ZIndex: =2

            ErrorMessage1 As label:
                AutoHeight: =true
                Height: =10
                Live: =Live.Assertive
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =Parent.Error
                Visible: =Parent.DisplayMode=DisplayMode.Edit
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardValue3.Y + DataCardValue3.Height
                ZIndex: =3

            StarVisible1 As label:
                Align: =Align.Center
                Color: =Color.Red
                Height: =DataCardKey3.Height
                Text: ="*"
                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                Width: =30
                Wrap: =false
                Y: =DataCardKey3.Y
                ZIndex: =4

        Edifício_DataCard1 As typedDataCard.comboBoxEditCard:
            BorderStyle: =BorderStyle.Solid
            DataField: ="uipp_Edificio"
            Default: =ThisItem.Edifício
            DisplayMode: =Parent.DisplayMode
            DisplayName: =DataSourceInfo([@Atividades],DataSourceInfo.DisplayName,"uipp_Edificio")
            Fill: =RGBA(0, 0, 0, 0)
            Height: =50
            Required: =false
            Update: =DataCardValue7.Selected
            Width: =329
            X: =2
            Y: =1
            ZIndex: =1

            DataCardKey8 As label:
                AutoHeight: =true
                Color: =cores.cinzento
                FontWeight: =FontWeight.Bold
                Height: =34
                Text: =Parent.DisplayName
                Width: =Parent.Width - 60
                Wrap: =false
                X: =30
                Y: =10
                ZIndex: =1

            DataCardValue7 As combobox:
                BorderColor: =If(IsBlank(Parent.Error), cores.cinzento, Color.Red)
                ChevronBackground: =cores.amareloMontepio
                ChevronHoverBackground: =cores.amareloMontepio
                DefaultSelectedItems: =Parent.Default
                DisplayFields: =["uipp_localizacao"]
                DisplayMode: =Parent.DisplayMode
                HoverBorderColor: =cores.cinzento
                HoverFill: =cores.amareloMontepio
                InputTextPlaceholder: ="Edifício"
                Items: =Choices([@Atividades].Edifício)
                PressedFill: =cores.amareloMontepio
                SearchFields: =["uipp_localizacao"]
                SearchItems: =Search(Choices([@Atividades].Edifício),DataCardValue7.SearchText,"uipp_localizacao")
                SelectionFill: =cores.amareloMontepio
                SelectMultiple: =false
                Tooltip: =Parent.DisplayName
                Width: =Parent.Width - 60
                X: =30
                Y: =49
                ZIndex: =2

            ErrorMessage6 As label:
                AutoHeight: =true
                Height: =10
                Live: =Live.Assertive
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =Parent.Error
                Visible: =Parent.DisplayMode=DisplayMode.Edit
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardValue7.Y + DataCardValue7.Height
                ZIndex: =3

            StarVisible6 As label:
                Align: =Align.Center
                Height: =DataCardKey8.Height
                Text: ="*"
                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                Width: =30
                Wrap: =false
                Y: =DataCardKey8.Y
                ZIndex: =4

        "'Descrição de atividade_DataCard1' As typedDataCard.textualMultiLineEditCard":
            BorderStyle: =BorderStyle.Solid
            DataField: ="uipp_descricaodeatividade"
            Default: =ThisItem.'Descrição de atividade'
            DisplayMode: =Parent.DisplayMode
            DisplayName: =DataSourceInfo([@Atividades],DataSourceInfo.DisplayName,"uipp_descricaodeatividade")
            Fill: =RGBA(0, 0, 0, 0)
            Height: =50
            Required: =false
            Update: =DataCardValue5.Text
            Width: =445
            WidthFit: =true
            X: =0
            Y: =2
            ZIndex: =1

            DataCardKey6 As label:
                AutoHeight: =true
                Color: =cores.cinzento
                FontWeight: =FontWeight.Bold
                Height: =34
                Text: =Parent.DisplayName
                Width: =Parent.Width - 60
                Wrap: =false
                X: =30
                Y: =10
                ZIndex: =1

            DataCardValue5 As text:
                BorderColor: =If(IsBlank(Parent.Error), cores.cinzento, Color.Red)
                Default: =Parent.Default
                DelayOutput: =true
                DisabledColor: =RGBA(0, 0, 0, 1)
                DisplayMode: =Parent.DisplayMode
                Height: =80
                HintText: ="Descrição de atividade"
                HoverBorderColor: =cores.cinzento
                HoverFill: =RGBA(255, 255, 255, 1)
                Mode: =TextMode.MultiLine
                PaddingLeft: =5
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Tooltip: =Parent.DisplayName
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardKey6.Y + DataCardKey6.Height + 5
                ZIndex: =2

            ErrorMessage4 As label:
                AutoHeight: =true
                Height: =10
                Live: =Live.Assertive
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =Parent.Error
                Visible: =Parent.DisplayMode=DisplayMode.Edit
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardValue5.Y + DataCardValue5.Height
                ZIndex: =3

            StarVisible4 As label:
                Align: =Align.Center
                Height: =DataCardKey6.Height
                Text: ="*"
                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                Width: =30
                Wrap: =false
                Y: =DataCardKey6.Y
                ZIndex: =4

        Estado_DataCard1 As typedDataCard.comboBoxOptionSetSingleEditCard:
            BorderStyle: =BorderStyle.Solid
            DataField: ="uipp_estado"
            Default: =ThisItem.Estado
            DisplayMode: =Parent.DisplayMode
            DisplayName: =DataSourceInfo([@Atividades],DataSourceInfo.DisplayName,"uipp_estado")
            Fill: =RGBA(0, 0, 0, 0)
            Height: =50
            Required: =false
            Update: =DataCardValue6.Selected.Value
            Visible: =false
            Width: =329
            X: =0
            Y: =3
            ZIndex: =1

            DataCardKey7 As label:
                AutoHeight: =true
                Height: =34
                Text: =Parent.DisplayName
                Width: =Parent.Width - 60
                Wrap: =false
                ZIndex: =1

            DataCardValue6 As combobox:
                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                Default: |-
                    =LookUp(
                        Choices('Estado Processo'),
                        Text(ThisRecord.Value) = "Em preenchimento"
                    )
                DefaultSelectedItems: |-
                    =/*If(
                        IsBlank([Parent.Default]),
                        */LookUp(
                            Choices('Estado Processo'),
                            Text(ThisRecord.Value) = "Em preenchimento"
                        )/*,
                        [Parent.Default]
                    )*/
                DisplayFields: =["Value"]
                DisplayMode: =Parent.DisplayMode
                IsSearchable: =false
                Items: =Choices('Estado Processo')
                PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                SearchFields: =["Value"]
                SearchItems: =[]
                SelectMultiple: =false
                Tooltip: =Parent.DisplayName
                Width: =Parent.Width - 60
                Y: =21
                ZIndex: =2

            ErrorMessage5 As label:
                AutoHeight: =true
                Height: =10
                Live: =Live.Assertive
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =Parent.Error
                Visible: =Parent.DisplayMode=DisplayMode.Edit
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardValue6.Y + DataCardValue6.Height
                ZIndex: =3

            StarVisible5 As label:
                Align: =Align.Center
                Height: =DataCardKey7.Height
                Text: ="*"
                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                Width: =30
                Wrap: =false
                Y: =DataCardKey7.Y
                ZIndex: =4

        "'Unidade Orgânica_DataCard1' As typedDataCard.textualEditCard":
            BorderStyle: =BorderStyle.Solid
            DataField: ="uipp_unidadeorganica"
            Default: =ThisItem.'Unidade Orgânica'
            DisplayMode: =Parent.DisplayMode
            DisplayName: =DataSourceInfo([@Atividades],DataSourceInfo.DisplayName,"uipp_unidadeorganica")
            Fill: =RGBA(0, 0, 0, 0)
            Height: =50
            MaxLength: =DataSourceInfo([@Atividades], DataSourceInfo.MaxLength, "uipp_unidadeorganica")
            Required: =false
            Update: =DataCardValue12.Text
            Visible: =false
            Width: =329
            X: =1
            Y: =3
            ZIndex: =1

            DataCardKey13 As label:
                AutoHeight: =true
                Height: =34
                Text: =Parent.DisplayName
                Width: =Parent.Width - 60
                Wrap: =false
                X: =30
                Y: =10
                ZIndex: =1

            DataCardValue12 As text:
                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                Default: |-
                    =If(
                        IsBlank(Parent.Default),
                        currentUser,
                        Parent.Default
                    )
                DelayOutput: =true
                DisplayMode: =Parent.DisplayMode
                MaxLength: =Parent.MaxLength
                PaddingLeft: =5
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Tooltip: =Parent.DisplayName
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardKey13.Y + DataCardKey13.Height + 5
                ZIndex: =2

            ErrorMessage11 As label:
                AutoHeight: =true
                Height: =10
                Live: =Live.Assertive
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =Parent.Error
                Visible: =Parent.DisplayMode=DisplayMode.Edit
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardValue12.Y + DataCardValue12.Height
                ZIndex: =3

            StarVisible11 As label:
                Align: =Align.Center
                Height: =DataCardKey13.Height
                Text: ="*"
                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                Width: =30
                Wrap: =false
                Y: =DataCardKey13.Y
                ZIndex: =4

    "Gallery2 As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
        DelayItemLoading: =true
        DisplayMode: |-
            =Switch(
                formMode,
                0,
                DisplayMode.Edit,
                1,
                DisplayMode.Edit,
                DisplayMode.View
            )
        Height: =480
        Items: =Choices('Tipo de Fator')
        Layout: =Layout.Vertical
        LoadingSpinner: =LoadingSpinner.Data
        TemplatePadding: =0
        TemplateSize: =96
        Visible: =Trim(Lower('Passos do Registo de Atividade'.Selected.titulo)) = Trim(Lower("Fatores de Criticidade"))
        Width: =990
        X: =360
        Y: =199
        ZIndex: =10

        Separator2 As rectangle:
            Height: =8
            OnSelect: =Select(Parent)
            Width: =Parent.TemplateWidth
            Y: =Parent.TemplateHeight - Self.Height
            ZIndex: =5

        Label5 As label:
            FontWeight: =FontWeight.Semibold
            Height: =50
            OnSelect: =Select(Parent)
            Text: =ThisItem.Value
            Width: =130
            Y: =5
            ZIndex: =6

        "'4horas' As text":
            Align: =Align.Center
            BorderColor: =cores.cinzento
            Default: |-
                =If(
                    formMode = FormMode.New,
                    Criticidade,
                    Value(
                        LookUp(
                            'Fatores de Criticidades',
                            Trim(Lower(ThisRecord.'ID Atividade'.ID)) = Text('Gallery Data'.Selected.ID)
                            And
                            Trim(Lower(ThisRecord.'Tipo de Fator')) = Trim(Lower(ThisItem.Value))
                        ).'quatro horas'
                    )
                )
            DelayOutput: =true
            DisplayMode: |-
                =Switch(
                    formMode,
                    0,
                    DisplayMode.Edit,
                    1,
                    DisplayMode.Edit,
                    DisplayMode.View
                )
            Format: =TextFormat.Number
            HoverBorderColor: =cores.cinzento
            HoverFill: =
            MaxLength: =1
            OnChange: |-
                =Select('Calculate RTO');
                
                If(
                    Value(Self.Text) > 0,
                    
                    Patch(
                        AtividadeFormMenu,
                        LookUp(
                            AtividadeFormMenu,
                            Trim(Lower(ThisRecord.titulo)) = Trim(Lower("Fatores de Criticidade"))
                        ),
                        {
                            estado: "feito"
                        }
                    ),
                    
                    Patch(
                        AtividadeFormMenu,
                        LookUp(
                            AtividadeFormMenu,
                            Trim(Lower(ThisRecord.titulo)) = Trim(Lower("Fatores de Criticidade"))
                        ),
                        {
                            estado: "em curso"
                        }
                    )
                )
            PaddingLeft: =5
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Reset: =true
            Tooltip: =
            Visible: =Trim(Lower('Passos do Registo de Atividade'.Selected.titulo)) = Trim(Lower("Fatores de Criticidade"))
            Width: =50
            X: =106
            Y: =10
            ZIndex: =7

        "'24horas' As text":
            Align: =Align.Center
            BorderColor: =cores.cinzento
            Default: |-
                =If(
                    formMode = FormMode.New,
                    If(
                        IsBlank('4horas'.Text)
                        Or
                        Value('4horas'.Text) = 0,
                        ""
                    ),
                    If(
                        formMode = FormMode.View,
                        Value(
                            LookUp(
                                'Fatores de Criticidades',
                                Trim(Lower(ThisRecord.'ID Atividade'.ID)) = Text('Gallery Data'.Selected.ID)
                                And
                                Trim(Lower(ThisRecord.'Tipo de Fator')) = Trim(Lower(ThisItem.Value))
                            ).'vinte quatro horas'
                        ),
                        If(
                            IsBlank(
                                LookUp(
                                    'Fatores de Criticidades',
                                    Trim(Lower(ThisRecord.'ID Atividade'.ID)) = Text('Gallery Data'.Selected.ID)
                                    And
                                    Trim(Lower(ThisRecord.'Tipo de Fator')) = Trim(Lower(ThisItem.Value))
                                ).'vinte quatro horas'
                            ),
                            "",
                            LookUp(
                                'Fatores de Criticidades',
                                Trim(Lower(ThisRecord.'ID Atividade'.ID)) = Text('Gallery Data'.Selected.ID)
                                And
                                Trim(Lower(ThisRecord.'Tipo de Fator')) = Trim(Lower(ThisItem.Value))
                            ).'vinte quatro horas'
                        )
                    )
                )
            DelayOutput: =true
            DisplayMode: |-
                =Switch(
                    formMode,
                    0, //Edit
                    If(
                        IsBlank('4horas'.Text) Or Value('4horas'.Text) = 0,
                        DisplayMode.Disabled,
                        DisplayMode.Edit
                    ),
                    1, //New
                    If(
                        IsBlank('4horas'.Text) Or Value('4horas'.Text) = 0,
                        DisplayMode.Disabled,
                        DisplayMode.Edit
                    ),
                    DisplayMode.View
                )
            Format: =TextFormat.Number
            HoverBorderColor: =cores.cinzento
            HoverFill: =
            MaxLength: =1
            Mode: =TextFormat.Number
            OnChange: =Select('Calculate RTO')
            PaddingLeft: =5
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Reset: =true
            Tooltip: =
            Visible: =Trim(Lower('Passos do Registo de Atividade'.Selected.titulo)) = Trim(Lower("Fatores de Criticidade"))
            Width: =50
            X: =216
            Y: =10
            ZIndex: =8

        "'48horas' As text":
            Align: =Align.Center
            BorderColor: =cores.cinzento
            Default: |-
                =If(
                    formMode = FormMode.New,
                    If(
                        IsBlank('24horas'.Text)
                        Or
                        Value('24horas'.Text) = 0,
                        ""
                    ),
                    If(
                        formMode = FormMode.View,
                        Value(
                            LookUp(
                                'Fatores de Criticidades',
                                Trim(Lower(ThisRecord.'ID Atividade'.ID)) = Text('Gallery Data'.Selected.ID)
                                And
                                Trim(Lower(ThisRecord.'Tipo de Fator')) = Trim(Lower(ThisItem.Value))
                            ).'quarenta oito horas'
                        ),
                        If(
                            IsBlank(
                                LookUp(
                                    'Fatores de Criticidades',
                                    Trim(Lower(ThisRecord.'ID Atividade'.ID)) = Text('Gallery Data'.Selected.ID)
                                    And
                                    Trim(Lower(ThisRecord.'Tipo de Fator')) = Trim(Lower(ThisItem.Value))
                                ).'quarenta oito horas'
                            ),
                            "",
                            LookUp(
                                'Fatores de Criticidades',
                                Trim(Lower(ThisRecord.'ID Atividade'.ID)) = Text('Gallery Data'.Selected.ID)
                                And
                                Trim(Lower(ThisRecord.'Tipo de Fator')) = Trim(Lower(ThisItem.Value))
                            ).'quarenta oito horas'
                        )
                    )
                )
            DelayOutput: =true
            DisplayMode: |-
                =Switch(
                    formMode,
                    0, //Edit
                    If(
                        IsBlank('24horas'.Text) Or Value('24horas'.Text) = 0,
                        DisplayMode.Disabled,
                        DisplayMode.Edit
                    ),
                    1, //New
                    If(
                        IsBlank('24horas'.Text) Or Value('24horas'.Text) = 0,
                        DisplayMode.Disabled,
                        DisplayMode.Edit
                    ),
                    DisplayMode.View
                )
            Format: =TextFormat.Number
            HoverBorderColor: =cores.cinzento
            HoverFill: =
            MaxLength: =1
            Mode: =TextFormat.Number
            OnChange: =Select('Calculate RTO')
            PaddingLeft: =5
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Reset: =true
            Tooltip: =
            Visible: =Trim(Lower('Passos do Registo de Atividade'.Selected.titulo)) = Trim(Lower("Fatores de Criticidade"))
            Width: =50
            X: =326
            Y: =10
            ZIndex: =9

        "'1semana' As text":
            Align: =Align.Center
            BorderColor: =cores.cinzento
            Default: |-
                =If(
                    formMode = FormMode.New,
                    If(
                        IsBlank('48horas'.Text)
                        Or
                        Value('48horas'.Text) = 0,
                        ""
                    ),
                    If(
                        formMode = FormMode.View,
                        Value(
                            LookUp(
                                'Fatores de Criticidades',
                                Trim(Lower(ThisRecord.'ID Atividade'.ID)) = Text('Gallery Data'.Selected.ID)
                                And
                                Trim(Lower(ThisRecord.'Tipo de Fator')) = Trim(Lower(ThisItem.Value))
                            ).'uma semana'
                        ),
                        If(
                            IsBlank(
                                LookUp(
                                    'Fatores de Criticidades',
                                    Trim(Lower(ThisRecord.'ID Atividade'.ID)) = Text('Gallery Data'.Selected.ID)
                                    And
                                    Trim(Lower(ThisRecord.'Tipo de Fator')) = Trim(Lower(ThisItem.Value))
                                ).'uma semana'
                            ),
                            "",
                            LookUp(
                                'Fatores de Criticidades',
                                Trim(Lower(ThisRecord.'ID Atividade'.ID)) = Text('Gallery Data'.Selected.ID)
                                And
                                Trim(Lower(ThisRecord.'Tipo de Fator')) = Trim(Lower(ThisItem.Value))
                            ).'uma semana'
                        )
                    )
                )
            DelayOutput: =true
            DisplayMode: |-
                =Switch(
                    formMode,
                    0, //Edit
                    If(
                        IsBlank('48horas'.Text) Or Value('48horas'.Text) = 0,
                        DisplayMode.Disabled,
                        DisplayMode.Edit
                    ),
                    1, //New
                    If(
                        IsBlank('48horas'.Text) Or Value('48horas'.Text) = 0,
                        DisplayMode.Disabled,
                        DisplayMode.Edit
                    ),
                    DisplayMode.View
                )
            Format: =TextFormat.Number
            HoverBorderColor: =cores.cinzento
            HoverFill: =
            MaxLength: =1
            Mode: =TextFormat.Number
            OnChange: =Select('Calculate RTO')
            PaddingLeft: =5
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Reset: =true
            Tooltip: =
            Visible: =Trim(Lower('Passos do Registo de Atividade'.Selected.titulo)) = Trim(Lower("Fatores de Criticidade"))
            Width: =50
            X: =436
            Y: =10
            ZIndex: =10

        "'2semanas' As text":
            Align: =Align.Center
            BorderColor: =cores.cinzento
            Default: |-
                =If(
                    formMode = FormMode.New,
                    If(
                        IsBlank('1semana'.Text)
                        Or
                        Value('1semana'.Text) = 0,
                        ""
                    ),
                    If(
                        formMode = FormMode.View,
                        Value(
                            LookUp(
                                'Fatores de Criticidades',
                                Trim(Lower(ThisRecord.'ID Atividade'.ID)) = Text('Gallery Data'.Selected.ID)
                                And
                                Trim(Lower(ThisRecord.'Tipo de Fator')) = Trim(Lower(ThisItem.Value))
                            ).'duas semanas'
                        ),
                        If(
                            IsBlank(
                                LookUp(
                                    'Fatores de Criticidades',
                                    Trim(Lower(ThisRecord.'ID Atividade'.ID)) = Text('Gallery Data'.Selected.ID)
                                    And
                                    Trim(Lower(ThisRecord.'Tipo de Fator')) = Trim(Lower(ThisItem.Value))
                                ).'duas semanas'
                            ),
                            "",
                            LookUp(
                                'Fatores de Criticidades',
                                Trim(Lower(ThisRecord.'ID Atividade'.ID)) = Text('Gallery Data'.Selected.ID)
                                And
                                Trim(Lower(ThisRecord.'Tipo de Fator')) = Trim(Lower(ThisItem.Value))
                            ).'duas semanas'
                        )
                    )
                )
            DelayOutput: =true
            DisplayMode: |-
                =Switch(
                    formMode,
                    0, //Edit
                    If(
                        IsBlank('1semana'.Text) Or Value('1semana'.Text) = 0,
                        DisplayMode.Disabled,
                        DisplayMode.Edit
                    ),
                    1, //New
                    If(
                        IsBlank('1semana'.Text) Or Value('1semana'.Text) = 0,
                        DisplayMode.Disabled,
                        DisplayMode.Edit
                    ),
                    DisplayMode.View
                )
            Format: =TextFormat.Number
            HoverBorderColor: =cores.cinzento
            HoverFill: =
            MaxLength: =1
            Mode: =TextFormat.Number
            OnChange: =Select('Calculate RTO')
            PaddingLeft: =5
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Reset: =true
            Tooltip: =
            Visible: =Trim(Lower('Passos do Registo de Atividade'.Selected.titulo)) = Trim(Lower("Fatores de Criticidade"))
            Width: =50
            X: =546
            Y: =10
            ZIndex: =11

        "'1mes' As text":
            Align: =Align.Center
            BorderColor: =cores.cinzento
            Default: |-
                =If(
                    formMode = FormMode.New,
                    If(
                        IsBlank('2semanas'.Text)
                        Or
                        Value('2semanas'.Text) = 0,
                        ""
                    ),
                    If(
                        formMode = FormMode.View,
                        Value(
                            LookUp(
                                'Fatores de Criticidades',
                                Trim(Lower(ThisRecord.'ID Atividade'.ID)) = Text('Gallery Data'.Selected.ID)
                                And
                                Trim(Lower(ThisRecord.'Tipo de Fator')) = Trim(Lower(ThisItem.Value))
                            ).'um mes'
                        ),
                        If(
                            IsBlank(
                                LookUp(
                                    'Fatores de Criticidades',
                                    Trim(Lower(ThisRecord.'ID Atividade'.ID)) = Text('Gallery Data'.Selected.ID)
                                    And
                                    Trim(Lower(ThisRecord.'Tipo de Fator')) = Trim(Lower(ThisItem.Value))
                                ).'um mes'
                            ),
                            "",
                            LookUp(
                                'Fatores de Criticidades',
                                Trim(Lower(ThisRecord.'ID Atividade'.ID)) = Text('Gallery Data'.Selected.ID)
                                And
                                Trim(Lower(ThisRecord.'Tipo de Fator')) = Trim(Lower(ThisItem.Value))
                            ).'um mes'
                        )
                    )
                )
            DelayOutput: =true
            DisplayMode: |-
                =Switch(
                    formMode,
                    0, //Edit
                    If(
                        IsBlank('2semanas'.Text) Or Value('2semanas'.Text) = 0,
                        DisplayMode.Disabled,
                        DisplayMode.Edit
                    ),
                    1, //New
                    If(
                        IsBlank('2semanas'.Text) Or Value('2semanas'.Text) = 0,
                        DisplayMode.Disabled,
                        DisplayMode.Edit
                    ),
                    DisplayMode.View
                )
            Format: =TextFormat.Number
            HoverBorderColor: =cores.cinzento
            HoverFill: =
            MaxLength: =1
            Mode: =TextFormat.Number
            OnChange: =Select('Calculate RTO')
            PaddingLeft: =5
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Reset: =true
            Tooltip: =
            Visible: =Trim(Lower('Passos do Registo de Atividade'.Selected.titulo)) = Trim(Lower("Fatores de Criticidade"))
            Width: =50
            X: =656
            Y: =10
            ZIndex: =12

        racional As text:
            BorderColor: =cores.cinzento
            Default: |-
                =If(
                    formMode = FormMode.New,
                    "",
                    Value(
                        LookUp(
                            'Fatores de Criticidades',
                            Trim(Lower(ThisRecord.'ID Atividade'.ID)) = Text('Gallery Data'.Selected.ID)
                            And
                            Trim(Lower(ThisRecord.'Tipo de Fator')) = Trim(Lower(ThisItem.Value))
                        ).Racional
                    )
                )
            DelayOutput: =true
            DisplayMode: |-
                =Switch(
                    formMode,
                    0,
                    DisplayMode.Edit,
                    1,
                    DisplayMode.Edit,
                    DisplayMode.View
                )
            Height: =81
            HoverBorderColor: =cores.cinzento
            HoverFill: =
            MaxLength: =255
            Mode: =TextMode.MultiLine
            PaddingLeft: =5
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Tooltip: =
            Visible: =Trim(Lower('Passos do Registo de Atividade'.Selected.titulo)) = Trim(Lower("Fatores de Criticidade"))
            Width: =218
            X: =759
            Y: =10
            ZIndex: =13

        StarVisible10_1 As label:
            Align: =Align.Center
            Color: =Color.Red
            Height: =DataCardKey12.Height
            Text: ="*"
            Visible: |-
                =If(
                    Gallery2.DisplayMode = DisplayMode.Edit,
                    true,
                    false
                )
            Width: =25
            Wrap: =false
            X: =156
            ZIndex: =14

        Dropdown2 As dropdown:
            Default: |-
                =LookUp(
                    Choices('Tipo de Fator'),
                    ThisRecord.Value = ThisItem.Value
                ).Value
            Items: =Choices('Tipo de Fator')
            OnSelect: =Select(Parent)
            Visible: =false
            X: =31
            Y: =56
            ZIndex: =15

        Label3 As label:
            OnSelect: =Select(Parent)
            Text: |-
                =If(
                    formMode <> FormMode.New,
                    Value(
                        LookUp(
                            'Fatores de Criticidades',
                            Trim(Lower(ThisRecord.'ID Atividade'.ID)) = Text('Gallery Data'.Selected.ID)
                            And
                            Trim(Lower(ThisRecord.'Tipo de Fator')) = Trim(Lower(ThisItem.Value))
                        ).ID
                    )
                )
            Visible: =false
            X: =288
            Y: =56
            ZIndex: =16

    Label3_11 As label:
        Align: =Align.Center
        FontWeight: =FontWeight.Semibold
        Text: ="Racional"
        Visible: =Trim(Lower('Passos do Registo de Atividade'.Selected.titulo)) = Trim(Lower("Fatores de Criticidade"))
        Width: =110
        X: =1171
        Y: =160
        ZIndex: =11

    RTO As groupContainer.manualLayoutContainer:
        Height: =80
        Visible: =Trim(Lower('Passos do Registo de Atividade'.Selected.titulo)) = Trim(Lower("Fatores de Criticidade"))
        Width: =723
        X: =360
        Y: =655
        ZIndex: =12

        Global As label:
            Fill: |-
                =//RGBA(0, 0, 0, 0)
                ColorFade(cores.amareloMontepio, 0.5)
            FontWeight: =FontWeight.Semibold
            Text: ="Global"
            Width: =734
            ZIndex: =1

        "'4Horas' As label":
            Align: =Align.Center
            FontWeight: =FontWeight.Bold
            Size: =14
            Text: |-
                =Max(
                    Gallery2.AllItems,
                    ThisRecord.'4horas'.Text
                )
            Width: =75
            X: =92
            ZIndex: =2

        "'24Horas' As label":
            Align: =Align.Center
            FontWeight: =FontWeight.Bold
            Size: =14
            Text: |-
                =Max(
                    Gallery2.AllItems,
                    ThisRecord.'24horas'.Text
                )
            Width: =75
            X: =202
            ZIndex: =3

        "'48Horas' As label":
            Align: =Align.Center
            FontWeight: =FontWeight.Bold
            Size: =14
            Text: |-
                =Max(
                    Gallery2.AllItems,
                    ThisRecord.'48horas'.Text
                )
            Width: =75
            X: =312
            ZIndex: =4

        "'1Semana' As label":
            Align: =Align.Center
            FontWeight: =FontWeight.Bold
            Size: =14
            Text: |-
                =Max(
                    Gallery2.AllItems,
                    ThisRecord.'1semana'.Text
                )
            Width: =75
            X: =422
            ZIndex: =5

        "'2Semanas' As label":
            Align: =Align.Center
            FontWeight: =FontWeight.Bold
            Size: =14
            Text: |-
                =Max(
                    Gallery2.AllItems,
                    ThisRecord.'2semanas'.Text
                )
            Width: =75
            X: =532
            ZIndex: =6

        "'1Mes' As label":
            Align: =Align.Center
            FontWeight: =FontWeight.Bold
            Size: =14
            Text: |-
                =Max(
                    Gallery2.AllItems,
                    ThisRecord.'1mes'.Text
                )
            Width: =75
            X: =643
            ZIndex: =7

        "'RTO label' As label":
            Align: =Align.Center
            Fill: =ColorFade(cores.cinzento, 0.9)
            FontWeight: =FontWeight.Bold
            Size: =15
            Text: |-
                =If(
                    formMode = 1,
                    "RTO: "
                    &
                    If(
                        IsBlank(RTOTempo),
                        "<4 horas",
                        RTOTempo
                    ),
                    
                    If(
                        Value('4Horas'.Text) > RTO,
                        RTOTempo,
                        If(
                            Value('24Horas'.Text) >= RTO,
                            RTOTempo,
                            If(
                                Value('48Horas'.Text) >= RTO,
                                RTOTempo,
                                If(
                                    Value('1Semana'.Text) >= RTO,
                                    RTOTempo,
                                    If(
                                        Value('2Semanas'.Text) >= RTO,
                                        RTOTempo,
                                        If(
                                            Value('1Mes'.Text) >= RTO,
                                            RTOTempo,
                                            LookUp(
                                                RTOS,
                                                ThisRecord.Atividade.ID = Text('Gallery Data'.Selected.ID)
                                            ).Classificação
                                        )
                                    )
                                )
                            )
                        )
                    )
                )
            Width: =734
            Y: =40
            ZIndex: =8

        "'Calculate RTO' As button":
            OnSelect: |+
                =UpdateContext({
                    RTO: 0,
                    RTOTempo: "<4 horas"
                });
                
                If( Value('4Horas'.Text) > RTO, UpdateContext({ RTO: Value('4Horas'.Text), RTOTempo: "<4 horas"}));
                If( Value('24Horas'.Text) >= RTO, UpdateContext({ RTO: Value('24Horas'.Text), RTOTempo: "<24 horas" }));
                If( Value('48Horas'.Text) >= RTO, UpdateContext({ RTO: Value('48Horas'.Text), RTOTempo: "<48 horas" }));
                If( Value('1Semana'.Text) >= RTO, UpdateContext({ RTO: Value('1Semana'.Text), RTOTempo: "<1 semana" }));
                If( Value('2Semanas'.Text) >= RTO, UpdateContext({ RTO: Value('2Semanas'.Text), RTOTempo: "<2 semanas" }));
                If( Value('1Mes'.Text) >= RTO, UpdateContext({ RTO: Value('1Mes'.Text), RTOTempo: "<1 mês" }));
                
                If(
                    Value('4Horas'.Text) = 4 Or
                    Value('24Horas'.Text) = 4 Or
                    Value('48Horas'.Text) = 4 Or
                    Value('1Semana'.Text) = 4 Or
                    Value('2Semanas'.Text) = 4 Or
                    Value('1Mes'.Text) = 4,
                    
                    UpdateIf(
                        AtividadeFormMenu,
                        !(
                            Trim(Lower("Caracterização do Processo")) = Trim(Lower(titulo))
                            Or
                            Trim(Lower("Fatores de Criticidade")) in Trim(Lower(titulo))
                        ),
                
                        {modo: DisplayMode.Edit}
                    ),
                    
                    UpdateIf(
                        AtividadeFormMenu,
                        !(
                            Trim(Lower("Caracterização do Processo")) = Trim(Lower(titulo))
                            Or
                            Trim(Lower("Fatores de Criticidade")) in Trim(Lower(titulo))
                        ),
                        {modo: DisplayMode.Disabled}
                    )
                )
                
                
                
            Text: ="Button"
            Visible: =false
            X: =569
            Y: =40
            ZIndex: =10

        Label8 As label:
            Text: |-
                =LookUp(
                    RTOS,
                    ThisRecord.Atividade.ID = Text('Gallery Data'.Selected.ID)
                ).ID
            Visible: =false
            X: =60
            Y: =40
            ZIndex: =11

    "'Caracterização dos Equipamentos' As group":
        Height: =5
        Width: =5
        X: =24
        Y: =40
        ZIndex: =18

        "'Caracterização dos equipamentos' As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
            DelayItemLoading: =true
            DisplayMode: |-
                =Switch(
                    formMode,
                    0,
                    DisplayMode.Edit,
                    1,
                    DisplayMode.Edit,
                    DisplayMode.View
                )
            Height: =514
            Items: =collectEquipamentos
            Layout: =Layout.Vertical
            LoadingSpinner: =LoadingSpinner.Data
            TemplatePadding: =0
            TemplateSize: =90
            Visible: =Trim(Lower('Passos do Registo de Atividade'.Selected.titulo)) = Trim(Lower("Caracterização dos Equipamentos"))
            Width: =945
            X: =382
            Y: =167
            ZIndex: =14

            EquipamentoAtividadeID As combobox:
                BorderColor: =cores.cinzento
                ChevronBackground: =cores.amareloMontepio
                DefaultSelectedItems: =First(Atividades)//LookUp(Atividades, ThisRecord.ID = LastAtividadeId)
                DisplayFields: =["uipp_atividade"]
                DisplayMode: =Parent.DisplayMode
                IsSearchable: =false
                Items: =Choices([@Pessoas].'ID Atividade')
                PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                SearchFields: =["uipp_atividade"]
                SearchItems: =[]
                SelectMultiple: =false
                Tooltip: =
                Visible: =false
                Width: =205
                ZIndex: =1

            SeparadorEquipamentos As rectangle:
                BorderColor: =cores.cinzento
                BorderStyle: =BorderStyle.Dashed
                BorderThickness: =0.5
                DisplayMode: =DisplayMode.View
                Fill: =cores.cinzento
                Height: =1
                OnSelect: =Select(Parent)
                Width: =Parent.TemplateWidth
                Y: =Parent.TemplateHeight - Self.Height
                ZIndex: =2

            "'Equipamento Duracao' As combobox":
                BorderColor: =cores.cinzento
                ChevronBackground: =cores.amareloMontepio
                ChevronHoverBackground: =ColorFade(cores.amareloMontepio, -20%)
                DefaultSelectedItems: |-
                    =If(
                        formMode = FormMode.New,
                        Blank(),
                        LookUp(
                            Choices('Duração (Pessoas)'),
                            ThisItem.Duracao in Text(ThisRecord.Value)
                        )
                    )
                DisplayFields: =["Value"]
                DisplayMode: =Parent.DisplayMode
                HoverFill: =cores.amareloMontepio
                IsSearchable: =false
                Items: =Choices('Duração (Pessoas)')
                NoSelectionText: ="Tempo"
                PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                PressedFill: =cores.amareloMontepio
                SearchFields: =["Value"]
                SearchItems: =[]
                SelectionFill: =cores.amareloMontepio
                SelectMultiple: =false
                Tooltip: =
                Width: =150
                X: =289
                Y: =40
                ZIndex: =7

            "'Equipamento Obs' As text":
                BorderColor: =cores.cinzento
                Default: |-
                    =If(
                        formMode = FormMode.New,
                        Blank(),
                        ThisItem.Observações
                    )
                DelayOutput: =true
                DisplayMode: =Parent.DisplayMode
                FontWeight: =FontWeight.Lighter
                HintText: ="Observações"
                HoverBorderColor: =cores.cinzento
                HoverFill: =RGBA(255, 255, 255, 1)
                MaxLength: =30
                Mode: =TextMode.MultiLine
                OnChange: =
                PaddingLeft: =5
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Tooltip: =
                Width: =443
                X: =454
                Y: =40
                ZIndex: =8

            "'Equipamentos Remove' As icon.Add":
                Color: =cores.cinzento
                Height: =30
                Icon: =Icon.Trash
                OnSelect: |-
                    =Select(Parent);
                    RemoveIf(
                        collectEquipamentos,
                        ThisRecord.row = ThisItem.row
                    )
                Width: =30
                X: =900
                Y: =25
                ZIndex: =9

            Equipamento As combobox:
                BorderColor: =cores.cinzento
                ChevronBackground: =cores.amareloMontepio
                ChevronHoverBackground: =ColorFade(cores.amareloMontepio, -20%)
                DefaultSelectedItems: |-
                    =LookUp(
                        Choices([@'Equipamentos de Escritório'].Equipamento),
                        ThisItem.Equipamento.Equipamento in ThisRecord.Equipamento
                    )
                DisplayFields: =["uipp_equipamento"]
                DisplayMode: =Parent.DisplayMode
                FocusedBorderColor: =cores.cinzento
                HoverBorderColor: =cores.cinzento
                HoverFill: =cores.amareloMontepio
                InputTextPlaceholder: ="Equipamento"
                Items: =Choices([@'Equipamentos de Escritório'].Equipamento)
                NoSelectionText: ="Equipamento"
                PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                PressedBorderColor: =cores.cinzento
                PressedFill: =cores.amareloMontepio
                SearchFields: =["uipp_equipamento"]
                SearchItems: =Search(Choices([@'Equipamentos de Escritório'].Equipamento),Equipamento.SearchText,"uipp_equipamento")
                SelectionFill: =cores.amareloMontepio
                SelectMultiple: =false
                Tooltip: =
                Width: =275
                Y: =40
                ZIndex: =10

            Label9 As label:
                Height: =17
                OnSelect: =Select(Parent)
                Text: |-
                    =If(
                        formMode = FormMode.New,
                        Blank(),
                        ThisItem.ID
                    )
                Visible: =false
                Width: =56
                X: =924
                Y: =73
                ZIndex: =11

            Llbtitulo_2 As Text:
                DisplayMode: =Parent.DisplayMode
                Height: =32
                Size: =12
                Text: ="Duração"
                Visible: =true
                Weight: ='TextCanvas.Weight'.Semibold
                Width: =96
                X: =289
                Y: =0
                ZIndex: =12

            Llbtitulo_1 As Text:
                DisplayMode: =Parent.DisplayMode
                Height: =32
                Size: =12
                Text: ="Equipamento"
                Visible: =true
                Weight: ='TextCanvas.Weight'.Semibold
                Width: =96
                X: =0
                Y: =0
                ZIndex: =13

            Llbtitulo As Text:
                DisplayMode: =Parent.DisplayMode
                Height: =32
                Size: =12
                Text: ="Observações"
                Visible: =true
                Weight: ='TextCanvas.Weight'.Semibold
                Width: =96
                X: =454
                Y: =0
                ZIndex: =14

        AddEquipamentoBTN As groupContainer:
            Height: =40
            Visible: |-
                =(
                    Value('4Horas'.Text) = 4 Or
                    Value('24Horas'.Text) = 4 Or
                    Value('48Horas'.Text) = 4 Or
                    Value('1Semana'.Text) = 4 Or
                    Value('2Semanas'.Text) = 4 Or
                    Value('1Mes'.Text) = 4
                )
                And
                Trim(Lower('Passos do Registo de Atividade'.Selected.titulo)) = Trim(Lower("Caracterização dos Equipamentos"))
            Width: =197
            X: =731
            Y: =655
            ZIndex: =16

            DynamicBtn_6 As DynamicBtn:
                BtnText: ="Adic. Equip."
                BtnWidth: =200
                Height: =40
                Visible: =Trim(Lower('Passos do Registo de Atividade'.Selected.titulo)) = Trim(Lower("Caracterização dos Equipamentos"))
                Width: =201
                ZIndex: =1

            "'Add Equipamento' As button":
                AutoDisableOnSelect: =false
                BorderColor: =Color.Transparent
                DisabledBorderColor: =Color.Transparent
                DisabledFill: =Color.Transparent
                Fill: =Color.Transparent
                HoverBorderColor: =Color.Transparent
                HoverFill: =Color.Transparent
                OnSelect: |-
                    =Collect(collectEquipamentos, {row: Last(collectEquipamentos).row + 1})
                PressedFill: =Color.Transparent
                Size: =13
                Text: =""
                Visible: =Trim(Lower('Passos do Registo de Atividade'.Selected.titulo)) = Trim(Lower("Caracterização dos Equipamentos"))
                Width: =201
                ZIndex: =2

    "'Caracterização dos Sistemas' As group":
        Height: =5
        Width: =5
        X: =24
        Y: =40
        ZIndex: =20

        "'Caracterização dos sistemas' As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
            DelayItemLoading: =true
            DisplayMode: |-
                =Switch(
                    formMode,
                    0,
                    DisplayMode.Edit,
                    1,
                    DisplayMode.Edit,
                    DisplayMode.View
                )
            Height: =514
            Items: =collectSistemas
            Layout: =Layout.Vertical
            LoadingSpinner: =LoadingSpinner.Data
            TemplatePadding: =0
            TemplateSize: =108
            Visible: =Trim(Lower('Passos do Registo de Atividade'.Selected.titulo)) = Trim(Lower("Caracterização dos Sistemas"))
            Width: =945
            X: =382
            Y: =167
            ZIndex: =17

            SistemasAtividadeID As combobox:
                BorderColor: =cores.cinzento
                ChevronBackground: =cores.amareloMontepio
                DefaultSelectedItems: =First(Atividades)//LookUp(Atividades, ThisRecord.ID = LastAtividadeId)
                DisplayFields: =["uipp_atividade"]
                DisplayMode: =Parent.DisplayMode
                IsSearchable: =false
                Items: =Choices([@Pessoas].'ID Atividade')
                PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                SearchFields: =["uipp_atividade"]
                SearchItems: =[]
                SelectMultiple: =false
                Tooltip: =
                Visible: =false
                Width: =205
                ZIndex: =1

            SeparadorSistemas As rectangle:
                BorderColor: =cores.cinzento
                BorderStyle: =BorderStyle.Dashed
                BorderThickness: =0.5
                DisplayMode: =DisplayMode.View
                Fill: =cores.cinzento
                Height: =1
                OnSelect: =Select(Parent)
                Width: =Parent.TemplateWidth
                Y: =Parent.TemplateHeight - Self.Height
                ZIndex: =2

            "'Sistemas Remove' As icon.Add":
                Color: =cores.cinzento
                Height: =30
                Icon: =Icon.Trash
                OnSelect: |-
                    =Select(Parent);
                    RemoveIf(
                        collectSistemas,
                        ThisRecord.row = ThisItem.row
                    )
                Width: =30
                X: =900
                Y: =28
                ZIndex: =3

            "'Sistemas Obs' As text":
                BorderColor: =cores.cinzento
                Default: |-
                    =If(
                        formMode = FormMode.New,
                        Blank(),
                        ThisItem.Observações
                    )
                DelayOutput: =true
                DisplayMode: =Parent.DisplayMode
                Height: =59
                HintText: ="Observações"
                HoverBorderColor: =cores.cinzento
                HoverFill: =RGBA(255, 255, 255, 1)
                MaxLength: =100
                Mode: =TextMode.MultiLine
                OnChange: =
                PaddingLeft: =5
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =12
                Tooltip: =
                Width: =268
                X: =621
                Y: =40
                ZIndex: =4

            "'Sistemas Descrição' As text":
                BorderColor: =cores.cinzento
                Default: |-
                    =If(
                        formMode = FormMode.New,
                        Blank(),
                        ThisItem.Descricao
                    )
                DelayOutput: =true
                DisplayMode: =Parent.DisplayMode
                Height: =59
                HintText: ="Descrição"
                HoverBorderColor: =cores.cinzento
                HoverFill: =RGBA(255, 255, 255, 1)
                MaxLength: =100
                Mode: =TextMode.MultiLine
                OnChange: =
                PaddingLeft: =5
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =12
                Tooltip: =
                Width: =282
                X: =328
                Y: =40
                ZIndex: =5

            "'Sistemas Duracao' As combobox":
                BorderColor: =cores.cinzento
                ChevronBackground: =cores.amareloMontepio
                ChevronHoverBackground: =ColorFade(cores.amareloMontepio, -20%)
                DefaultSelectedItems: |-
                    =If(
                        formMode = FormMode.New,
                        Blank(),
                        LookUp(
                            Choices('Duração (Pessoas)'),
                            ThisItem.Duracao in Text(ThisRecord.Value)
                        )
                    )
                DisplayFields: =["Value"]
                DisplayMode: =Parent.DisplayMode
                HoverFill: =cores.amareloMontepio
                IsSearchable: =false
                Items: =Choices('Duração (Pessoas)')
                NoSelectionText: ="Tempo"
                PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                PressedFill: =cores.amareloMontepio
                SearchFields: =["Value"]
                SearchItems: =[]
                SelectionFill: =cores.amareloMontepio
                SelectMultiple: =false
                Tooltip: =
                Width: =150
                X: =162
                Y: =40
                ZIndex: =6

            Sistema As combobox:
                BorderColor: =cores.cinzento
                ChevronBackground: =cores.amareloMontepio
                ChevronHoverBackground: =ColorFade(cores.amareloMontepio, -20%)
                DefaultSelectedItems: |-
                    =If(
                        formMode = FormMode.New,
                        Blank(),
                        LookUp(
                            Choices([@Sistemas].'Sistemas/Aplicações'),
                            ThisItem.Sistema.Nome in ThisRecord.Nome
                        )
                    )
                DisplayFields: =["uipp_nome"]
                DisplayMode: =Parent.DisplayMode
                HoverBorderColor: =ColorFade(cores.cinzento, 15%)
                HoverFill: =cores.amareloMontepio
                InputTextPlaceholder: ="Sistema/App"
                IsSearchable: =false
                Items: =Choices([@Sistemas].'Sistemas/Aplicações')
                NoSelectionText: ="Sistema/App"
                PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                PressedFill: =cores.amareloMontepio
                SearchFields: =["uipp_nome"]
                SearchItems: =[]
                SelectionFill: =cores.amareloMontepio
                SelectMultiple: =false
                Tooltip: =Self.Selected.Nome
                Width: =148
                Y: =40
                ZIndex: =7

            Label9_1 As label:
                Height: =17
                OnSelect: =Select(Parent)
                Text: |-
                    =If(
                        formMode = FormMode.New,
                        Blank(),
                        ThisItem.ID
                    )
                Visible: =false
                Width: =56
                X: =924
                Y: =73
                ZIndex: =8

            TextCanvas8 As Text:
                DisplayMode: =DisplayMode.Edit
                Height: =32
                Text: ="Sistema"
                Weight: ='TextCanvas.Weight'.Semibold
                Width: =96
                X: =0
                Y: =4
                ZIndex: =9

            TextCanvas8_1 As Text:
                DisplayMode: =DisplayMode.Edit
                Height: =32
                Text: ="Duração"
                Weight: ='TextCanvas.Weight'.Semibold
                Width: =96
                X: =162
                Y: =8
                ZIndex: =10

            TextCanvas8_2 As Text:
                DisplayMode: =DisplayMode.Edit
                Height: =32
                Text: ="Descrição"
                Weight: ='TextCanvas.Weight'.Semibold
                Width: =96
                X: =328
                Y: =8
                ZIndex: =11

            TextCanvas8_3 As Text:
                DisplayMode: =DisplayMode.Edit
                Height: =32
                Text: ="Observações"
                Weight: ='TextCanvas.Weight'.Semibold
                Width: =96
                X: =621
                Y: =8
                ZIndex: =12

        AddSistemasBTN As groupContainer:
            Height: =40
            Visible: |-
                =(
                    Value('4Horas'.Text) = 4 Or
                    Value('24Horas'.Text) = 4 Or
                    Value('48Horas'.Text) = 4 Or
                    Value('1Semana'.Text) = 4 Or
                    Value('2Semanas'.Text) = 4 Or
                    Value('1Mes'.Text) = 4
                )
                And
                Trim(Lower('Passos do Registo de Atividade'.Selected.titulo)) = Trim(Lower("Caracterização dos Sistemas"))
            Width: =194
            X: =726
            Y: =655
            ZIndex: =18

            DynamicBtn_7 As DynamicBtn:
                BtnText: ="Adic. Sistema"
                BtnWidth: =200
                Height: =40
                Visible: =Trim(Lower('Passos do Registo de Atividade'.Selected.titulo)) = Trim(Lower("Caracterização dos Sistemas"))
                Width: =201
                ZIndex: =1

            "'Add Sistemas' As button":
                AutoDisableOnSelect: =false
                BorderColor: =Color.Transparent
                DisabledBorderColor: =Color.Transparent
                DisabledFill: =Color.Transparent
                Fill: =Color.Transparent
                HoverBorderColor: =Color.Transparent
                HoverFill: =Color.Transparent
                OnSelect: |-
                    =Collect(collectSistemas, {row: Last(collectSistemas).row + 1})
                PressedFill: =Color.Transparent
                Size: =13
                Text: =""
                Visible: =Trim(Lower('Passos do Registo de Atividade'.Selected.titulo)) = Trim(Lower("Caracterização dos Sistemas"))
                Width: =201
                ZIndex: =2

    Header As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =20

        "'Passos do Registo de Atividade' As gallery.'BrowseLayout_Horizontal_TwoTextOneImageVariant_ver5.0'":
            DelayItemLoading: =true
            DisplayMode: |
                =DisplayMode.Edit
            Height: =61
            Items: =AtividadeFormMenu
            LoadingSpinner: =LoadingSpinner.Data
            TemplatePadding: =0
            TemplateSize: ='Passos do Registo de Atividade'.Width / 'Passos do Registo de Atividade'.AllItemsCount
            Width: =945
            X: =382
            Y: =91
            ZIndex: =20

            Rectangle4 As rectangle:
                Fill: |-
                    =If(
                        formMode = 2,
                        Color.Green,
                        Switch(
                            ThisItem.estado,
                            "em curso",
                            cores.amareloMontepio,
                            "em falta",
                            Color.Red,
                            "feito",
                            Color.Green
                        )
                    )
                Height: =2
                OnSelect: =Select(Parent)
                Width: =Parent.Width / Parent.AllItemsCount
                Y: =47
                ZIndex: =1

            Label2 As label:
                Align: =Align.Center
                DisplayMode: |-
                    =/*If(
                        ThisItem.titulo = "Caracterização do Processo" Or ThisItem.titulo = "Fatores de Criticidade",
                        
                        DisplayMode.Edit,
                        
                        If(
                            Value('4Horas'.Text) = 4 Or
                            Value('24Horas'.Text) = 4 Or
                            Value('48Horas'.Text) = 4 Or
                            Value('1Semana'.Text) = 4 Or
                            Value('2Semanas'.Text) = 4 Or
                            Value('1Mes'.Text) = 4,
                    
                            DisplayMode.Edit,
                    
                            DisplayMode.Disabled
                        )
                    )*/
                    ThisItem.modo
                FontWeight: |-
                    =If(
                        ThisItem.IsSelected,
                        FontWeight.Bold,
                        FontWeight.Normal
                    )
                Height: =61
                OnSelect: |-
                    =If(
                        ThisItem.titulo <> "Caracterização do Processo" Or ThisItem.titulo <> "Fatores de Criticidade",
                        If(
                            Value('4Horas'.Text) = 4 Or
                            Value('24Horas'.Text) = 4 Or
                            Value('48Horas'.Text) = 4 Or
                            Value('1Semana'.Text) = 4 Or
                            Value('2Semanas'.Text) = 4 Or
                            Value('1Mes'.Text) = 4,
                            
                            Select(Parent);
                            If(
                                ThisItem.estado <> "feito",
                                Patch(
                                    AtividadeFormMenu,
                                    LookUp(
                                        AtividadeFormMenu,
                                        Trim(Lower(ThisRecord.titulo)) = Trim(Lower(ThisItem.titulo))
                                    ),
                                    {
                                        estado: "em curso"
                                    }
                                )
                            ),
                            false
                        ),
                        false
                    )
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingTop: =0
                Size: =12
                Text: =ThisItem.titulo
                VerticalAlign: =VerticalAlign.Top
                Width: =Parent.Width / Parent.AllItemsCount
                ZIndex: =2

        "'Title Container' As groupContainer":
            DropShadow: =DropShadow.None
            Height: =47
            Width: =1026
            X: =319
            Y: =28
            ZIndex: =22

            Label1_3 As label:
                Size: =15
                Text: |-
                    ="Atividades > " &
                    If(
                        formMode = FormMode.New,
                        "Criar registo de Atividade",
                        "Editar registo de Atividade"
                    )
                Width: =610
                X: =40
                ZIndex: =1

            SaveEditBtn As DynamicBtn:
                BtnText: |-
                    =If(
                        currentUser <> "DRI",
                        If(
                            formMode = 2,
                            "Editar",
                            "Guardar"
                        ),
                        If(
                            AtividadeRecord.'Unidade Orgânica' = "DRI" Or formMode = 1,
                            If(
                                formMode = 2,
                                "Editar",
                                "Guardar"
                            )
                        )
                    )
                BtnWidth: =200
                ButtonIcon: |-
                    =If(
                        currentUser <> "DRI",
                        If(
                            formMode = 2,
                            Icon.Edit,
                            Icon.Save
                        ),
                        If(
                            AtividadeRecord.'Unidade Orgânica' = "DRI" Or formMode = 1,
                            If(
                                formMode = 2,
                                Icon.Edit,
                                Icon.Save
                            )
                        )
                    )
                Height: =40
                Visible: =AtividadeRecord.Estado = 'Estado Processo'.'Em preenchimento' Or formMode = 1
                Width: =201
                X: =790
                Y: =5
                ZIndex: =2

            SaveEditBtnCode As button:
                Color: =Color.Transparent
                Fill: =Color.Transparent
                HoverColor: =Color.Transparent
                HoverFill: =Color.Transparent
                OnSelect: |-
                    =If(
                        formMode = 2,
                        UpdateContext({formMode: FormMode.Edit}),
                    // Submeter Caracterização do Processo
                    If(
                        'Caracterizacao do Processo'.Valid
                        And
                        (
                            LookUp(
                                AtividadeFormMenu,
                                Trim(Lower(titulo)) = Trim(Lower("Caracterização do Processo"))
                            ).estado = "feito"
                            And
                            LookUp(
                                AtividadeFormMenu,
                                Trim(Lower(titulo)) = Trim(Lower("Fatores de Criticidade"))
                            ).estado = "feito"
                        )
                        And
                        //Criticidade do Processo
                        (
                            !IsBlank(First(Gallery2.AllItems).'4horas'.Text) And If(
                                !IsBlank(First(Gallery2.AllItems).'24horas'.Text),
                                Value(First(Gallery2.AllItems).'4horas'.Text) <= Value(First(Gallery2.AllItems).'24horas'.Text),
                                true
                            ) And If(
                                !IsBlank(First(Gallery2.AllItems).'48horas'.Text),
                                Value(First(Gallery2.AllItems).'24horas'.Text) <= Value(First(Gallery2.AllItems).'48horas'.Text),
                                true
                            ) And If(
                                !IsBlank(First(Gallery2.AllItems).'1semana'.Text),
                                Value(First(Gallery2.AllItems).'48horas'.Text) <= Value(First(Gallery2.AllItems).'1semana'.Text),
                                true
                            ) And If(
                                !IsBlank(First(Gallery2.AllItems).'2semanas'.Text),
                                Value(First(Gallery2.AllItems).'1semana'.Text) <= Value(First(Gallery2.AllItems).'2semanas'.Text),
                                true
                            ) And If(
                                !IsBlank(First(Gallery2.AllItems).'1mes'.Text),
                                Value(First(Gallery2.AllItems).'2semanas'.Text) <= Value(First(Gallery2.AllItems).'1mes'.Text),
                                true
                            )
                        ),
                        //em caso de sucesso
                        UpdateContext(
                            {
                                ModalForm: {
                                    visible: true,
                                    texto: "Deseja submeter os dados da Atividade " & DataCardValue3.Text & "?"
                                }
                            }
                        )
                      ,
                        //em caso de erro
                        Notify( "Preencha todos os campos necessários, verifique se existem registos em branco e tente novamente", NotificationType.Error, 4000)
                      
                    )
                    )
                PressedColor: =Color.Transparent
                PressedFill: =Color.Transparent
                Text: =""
                Visible: =AtividadeRecord.Estado = 'Estado Processo'.'Em preenchimento' Or formMode = 1
                Width: =201
                X: =790
                Y: =5
                ZIndex: =3

            CancelAndAporoveBtn As DynamicBtn:
                BtnText: |-
                    =If(
                        formMode = 0,
                        "Cancelar",
                        "Pedir Aprovação"
                    )
                BtnWidth: =215
                ButtonIcon: |-
                    =If(
                        formMode = 0,
                        Icon.Cancel,
                        Icon.Send
                    )
                Height: =40
                Visible: |-
                    =(
                        AtividadeRecord.Estado = 'Estado Processo'.'Em validação'
                        Or
                        AtividadeRecord.Estado = 'Estado Processo'.'Em revalidação'
                        Or 
                            AtividadeRecord.Estado = 'Estado Processo'.'Em preenchimento'
                    )
                    And
                    currentUser = 'Gallery Data'.Selected.'Unidade Orgânica'
                Width: =207
                X: |-
                    =If(
                        HistoricoBtn.Visible Or
                        SaveEditBtn.Visible,
                        570,
                        790
                    )
                Y: =5
                ZIndex: =4

            CancelAndAporoveBtnCode As button:
                Color: =Color.Transparent
                Fill: =Color.Transparent
                HoverColor: =Color.Transparent
                HoverFill: =Color.Transparent
                OnSelect: |-
                    =If(
                        formMode = 0,
                        
                        UpdateContext({formMode: FormMode.View}),
                        
                        Concurrent(
                            Patch(
                                Atividades,
                                LookUp(
                                    Atividades,
                                    ThisRecord.ID = 'Gallery Data'.Selected.ID
                                ),
                                {
                                    Estado: 'Estado Processo'.'Em validação'
                                }
                            ),
                    
                            Patch(
                                'Histórico de aprovações',
                                Defaults('Histórico de aprovações'),
                                {
                                    Estado: 'Estado Processo'.'Em validação',
                                    'ID Atividade':
                                        LookUp(
                                            Atividades,
                                            ThisRecord.ID = 'Gallery Data'.Selected.ID
                                        )
                                }
                            ),
                    
                            'GCN-Pediraprovação'.Run(
                                'Gallery Data'.Selected.ID,
                                currentUser,
                                'Gallery Data'.Selected.Atividade
                            ),
                            Notify("Pedido de Aprovação enviado com sucesso", NotificationType.Success)
                        )
                    )
                PressedColor: =Color.Transparent
                PressedFill: =Color.Transparent
                Text: =""
                Visible: |-
                    =(
                        AtividadeRecord.Estado = 'Estado Processo'.'Em validação'
                        Or
                        AtividadeRecord.Estado = 'Estado Processo'.'Em revalidação'
                         Or
                        AtividadeRecord.Estado = 'Estado Processo'.'Em preenchimento'
                    )
                    And
                    currentUser = 'Gallery Data'.Selected.'Unidade Orgânica'
                Width: =201
                X: |-
                    =If(
                        HistoricoBtn.Visible
                        Or
                        SaveEditBtn.Visible,
                        576,
                        790
                    )
                Y: =5
                ZIndex: =5

            HistoricoBtn As DynamicBtn:
                BtnText: ="Histórico"
                BtnWidth: =200
                ButtonIcon: =Icon.History
                Height: =40
                Visible: |-
                    =AtividadeRecord.Estado <> 'Estado Processo'.'Em preenchimento'
                    And
                    formMode = 2
                    And
                    !IsBlank(
                        Filter(
                            'Histórico de aprovações',
                            ThisRecord.'ID Atividade'.ID = 'Gallery Data'.Selected.ID
                        )
                    )
                Width: =201
                X: =790
                Y: =5
                ZIndex: =6

            HistoricoBtnCode As button:
                Color: =Color.Transparent
                Fill: =Color.Transparent
                HoverColor: =Color.Transparent
                HoverFill: =Color.Transparent
                OnSelect: |-
                    =Navigate(
                        'Histórico de Aprovações',
                        ScreenTransition.None,
                        {
                            recordId: 'Gallery Data'.Selected.ID
                        }
                    )
                PressedColor: =Color.Transparent
                PressedFill: =Color.Transparent
                Text: =""
                Visible: |-
                    =AtividadeRecord.Estado <> 'Estado Processo'.'Em preenchimento'
                    And
                    formMode = 2
                    And
                    !IsBlank(
                        Filter(
                            'Histórico de aprovações',
                            ThisRecord.'ID Atividade'.ID = 'Gallery Data'.Selected.ID
                        )
                    )
                Width: =201
                X: =790
                Y: =5
                ZIndex: =7

    "'Caracterização dos Recursos' As group":
        Height: =5
        Width: =5
        X: =60
        Y: =60
        ZIndex: =22

        "'Caracterização dos recursos' As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
            DelayItemLoading: =true
            DisplayMode: |-
                =Switch(
                    formMode,
                    0,
                    DisplayMode.Edit,
                    1,
                    DisplayMode.Edit,
                    DisplayMode.View
                )
            Height: =514
            Items: =collectRecursos
            Layout: =Layout.Vertical
            LoadingSpinner: =LoadingSpinner.Data
            TemplatePadding: =0
            TemplateSize: =120
            Visible: |-
                =(
                    Value('4Horas'.Text) = 4 Or
                    Value('24Horas'.Text) = 4 Or
                    Value('48Horas'.Text) = 4 Or
                    Value('1Semana'.Text) = 4 Or
                    Value('2Semanas'.Text) = 4 Or
                    Value('1Mes'.Text) = 4
                )
                And
                Trim(Lower('Passos do Registo de Atividade'.Selected.titulo)) = Trim(Lower("Caracterização dos Recursos"))
            Width: =960
            X: =382
            Y: =165
            ZIndex: =13

            AtividadeID As combobox:
                BorderColor: =cores.cinzento
                ChevronBackground: =cores.amareloMontepio
                DefaultSelectedItems: =First(Atividades)//LookUp(Atividades, ThisRecord.ID = LastAtividadeId)
                DisplayFields: =["uipp_atividade"]
                DisplayMode: =Parent.DisplayMode
                IsSearchable: =false
                Items: =Choices([@Pessoas].'ID Atividade')
                PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                SearchFields: =["uipp_atividade"]
                SearchItems: =[]
                SelectMultiple: =false
                Tooltip: =
                Visible: =false
                Width: =205
                ZIndex: =1

            SeparadorRecursos As rectangle:
                BorderColor: =cores.cinzento
                BorderStyle: =BorderStyle.Dashed
                BorderThickness: =0.5
                DisplayMode: =DisplayMode.View
                Fill: =cores.cinzento
                Height: =1
                OnSelect: =Select(Parent)
                Width: =Parent.TemplateWidth
                Y: =Parent.TemplateHeight - Self.Height
                ZIndex: =2

            NumEmpregado As text:
                BorderColor: =cores.cinzento
                Default: |-
                    =If(
                        formMode = FormMode.New,
                        "",
                        ThisItem.NumEmpregado
                    )
                DelayOutput: =true
                DisplayMode: =Parent.DisplayMode
                FontWeight: =FontWeight.Lighter
                HintText: ="Núm. Empregado"
                HoverBorderColor: =cores.cinzento
                HoverFill: =RGBA(255, 255, 255, 1)
                MaxLength: =10
                OnChange: |-
                    =If(
                        !IsBlank(NumEmpregado.Text) And !IsBlank(Critico.Text) And !IsBlank(Teletrabalho.Selected.Value) And !IsBlank(Tipo.Selected.ID) And !IsBlank(Duracao.Selected.Value),
                        
                        Patch(
                            AtividadeFormMenu,
                            LookUp(
                                AtividadeFormMenu,
                                Trim(Lower(ThisRecord.titulo)) = Trim(Lower("Caracterização do Recursos"))
                            ),
                            {
                                estado: "feito"
                            }
                        ),
                    
                        Patch(
                            AtividadeFormMenu,
                            LookUp(
                                AtividadeFormMenu,
                                Trim(Lower(ThisRecord.titulo)) = Trim(Lower("Caracterização do Recursos"))
                            ),
                            {
                                estado: "em curso"
                            }
                        )
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Tooltip: =
                Width: =125
                X: =2
                Y: =14
                ZIndex: =3

            Critico As text:
                BorderColor: =cores.cinzento
                Default: |-
                    =If(
                        formMode = FormMode.New,
                        "",
                        ThisItem.Colaborador
                    )
                DelayOutput: =true
                DisplayMode: =Parent.DisplayMode
                FontWeight: =FontWeight.Lighter
                HintText: ="Nome do Colaborador"
                HoverBorderColor: =cores.cinzento
                HoverFill: =RGBA(255, 255, 255, 1)
                MaxLength: =30
                OnChange: =
                PaddingLeft: =5
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Tooltip: =
                Width: =298
                X: =141
                Y: =14
                ZIndex: =4

            Teletrabalho As combobox:
                BorderColor: =cores.cinzento
                ChevronBackground: =cores.amareloMontepio
                ChevronHoverBackground: =ColorFade(cores.amareloMontepio, -20%)
                DefaultSelectedItems: |-
                    =If(
                        formMode = FormMode.New,
                        Blank(),
                        LookUp(
                            Choices('Teletrabalho (Pessoas)'),
                            ThisItem.Teletrabalho in Text(ThisRecord.Value)
                        )
                    )
                DisplayFields: =["Value"]
                DisplayMode: =Parent.DisplayMode
                HoverFill: =cores.amareloMontepio
                InputTextPlaceholder: =""
                IsSearchable: =false
                Items: |
                    =Choices('Teletrabalho (Pessoas)')
                NoSelectionText: ="Teletrabalho"
                OnChange: =
                PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                PressedFill: =cores.amareloMontepio
                SearchFields: =["Value"]
                SearchItems: =[]
                SelectionFill: =cores.amareloMontepio
                SelectMultiple: =false
                Tooltip: =
                Width: =125
                X: =2
                Y: =63
                ZIndex: =5

            Tipo As combobox:
                BorderColor: =cores.cinzento
                ChevronBackground: =cores.amareloMontepio
                ChevronHoverBackground: =ColorFade(cores.amareloMontepio, -20%)
                DefaultSelectedItems: |
                    =LookUp(
                        Choices([@Pessoas].Tipo),
                        ThisItem.Tipo in ThisRecord.Tipo
                    )
                DisplayFields: =["uipp_tipo"]
                DisplayMode: =Parent.DisplayMode
                HoverFill: =cores.amareloMontepio
                InputTextPlaceholder: =""
                IsSearchable: =false
                Items: =Choices([@Pessoas].Tipo)
                NoSelectionText: ="Tipo Colab."
                OnChange: =
                PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                PressedFill: =cores.amareloMontepio
                SearchFields: =["uipp_tipo"]
                SearchItems: =[]
                SelectionFill: =cores.amareloMontepio
                SelectMultiple: =false
                Tooltip: =
                Width: =140
                X: =141
                Y: =63
                ZIndex: =6

            Duracao As combobox:
                BorderColor: =cores.cinzento
                ChevronBackground: =cores.amareloMontepio
                ChevronHoverBackground: =ColorFade(cores.amareloMontepio, -20%)
                DefaultSelectedItems: |-
                    =If(
                        formMode = FormMode.New,
                        Blank(),
                        LookUp(
                            Choices('Duração (Pessoas)'),
                            ThisItem.Duracao in Text(ThisRecord.Value)
                        )
                    )
                DisplayFields: =["Value"]
                DisplayMode: =Parent.DisplayMode
                HoverFill: =cores.amareloMontepio
                IsSearchable: =false
                Items: =Choices('Duração (Pessoas)')
                NoSelectionText: ="Tempo"
                PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                PressedFill: =cores.amareloMontepio
                SearchFields: =["Value"]
                SearchItems: =[]
                SelectionFill: =cores.amareloMontepio
                SelectMultiple: =false
                Tooltip: =
                Width: =150
                X: =289
                Y: =63
                ZIndex: =7

            Critico_1 As text:
                BorderColor: =cores.cinzento
                Default: |-
                    =If(
                        formMode = FormMode.New,
                        "",
                        ThisItem.Observações
                    )
                DelayOutput: =true
                DisplayMode: =Parent.DisplayMode
                FontWeight: =FontWeight.Lighter
                Height: =89
                HintText: ="Observações"
                HoverBorderColor: =cores.cinzento
                HoverFill: =RGBA(255, 255, 255, 1)
                MaxLength: =30
                Mode: =TextMode.MultiLine
                OnChange: =
                PaddingLeft: =5
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =12
                Tooltip: ="Observações"
                Width: =440
                X: =454
                Y: =14
                ZIndex: =8

            Icon3 As icon.Add:
                Color: =cores.cinzento
                Height: =30
                Icon: =Icon.Trash
                OnSelect: |-
                    =Select(Parent);
                    RemoveIf(
                        collectRecursos,
                        ThisRecord.row = ThisItem.row
                    )
                Visible: =If(currentUser = "DRI", false, true)
                Width: =30
                X: =900
                Y: =40
                ZIndex: =9

            Label6 As label:
                OnSelect: =Select(Parent)
                Text: =ThisItem.ID
                Visible: =false
                Width: =56
                X: =924
                Y: =80
                ZIndex: =10

        AddRecursoBTN As groupContainer:
            Height: =40
            Visible: |-
                =(
                    Value('4Horas'.Text) = 4 Or
                    Value('24Horas'.Text) = 4 Or
                    Value('48Horas'.Text) = 4 Or
                    Value('1Semana'.Text) = 4 Or
                    Value('2Semanas'.Text) = 4 Or
                    Value('1Mes'.Text) = 4
                )
                And
                Trim(Lower('Passos do Registo de Atividade'.Selected.titulo)) = Trim(Lower("Caracterização dos Recursos"))
            Width: =197
            X: =731
            Y: =655
            ZIndex: =15

            DynamicBtn_5 As DynamicBtn:
                BtnText: ="Adic. Recurso"
                BtnWidth: =200
                Height: =40
                Width: =201
                ZIndex: =1

            "'Add Recurso' As button":
                BorderColor: =Color.Transparent
                DisabledBorderColor: =Color.Transparent
                DisabledFill: =Color.Transparent
                Fill: =Color.Transparent
                HoverBorderColor: =Color.Transparent
                HoverFill: =Color.Transparent
                OnSelect: |-
                    =Collect(collectRecursos, {row: Last(collectRecursos).row + 1})
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                PressedFill: =Color.Transparent
                Size: =13
                Text: =""
                Visible: |
                    =Trim(Lower('Passos do Registo de Atividade'.Selected.titulo)) = Trim(Lower("Caracterização dos Recursos"))
                Width: =200
                ZIndex: =2

    Label7 As label:
        Align: =Align.Center
        FontWeight: =FontWeight.Bold
        Size: =15
        Text: ="Sem dados para apresentar, de momento"
        Visible: |-
            =Switch(
                Trim(Lower('Passos do Registo de Atividade'.Selected.titulo)),
                
                Trim(Lower("Caracterização dos Recursos")),
                If(CountRows(collectRecursos) = 0, true, false),
            
                Trim(Lower("Caracterização dos Equipamentos")),
                If(CountRows(collectEquipamentos) = 0, true, false),
            
                Trim(Lower("Caracterização dos Sistemas")),
                If(CountRows(collectSistemas) = 0, true, false),
            
                Trim(Lower("Dependências")),
                If(CountRows(collectDependencias) = 0, true, false)
            )
        Width: =980
        X: =362
        Y: =165
        ZIndex: =23

    "'Caracterização das Dependencias' As group":
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =23

        "'Caracterização das dependencias' As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
            DelayItemLoading: =true
            DisplayMode: |-
                =Switch(
                    formMode,
                    0,
                    DisplayMode.Edit,
                    1,
                    DisplayMode.Edit,
                    DisplayMode.View
                )
            Height: =514
            Items: =collectDependencias
            Layout: =Layout.Vertical
            LoadingSpinner: =LoadingSpinner.Data
            TemplatePadding: =0
            TemplateSize: =322
            Visible: =Trim(Lower('Passos do Registo de Atividade'.Selected.titulo)) = Trim(Lower("Dependências"))
            Width: =945
            X: =382
            Y: =167
            ZIndex: =19

            AtividadeID_1 As combobox:
                BorderColor: =cores.cinzento
                ChevronBackground: =cores.amareloMontepio
                DefaultSelectedItems: =First(Atividades)//LookUp(Atividades, ThisRecord.ID = LastAtividadeId)
                DisplayFields: =["uipp_atividade"]
                DisplayMode: =Parent.DisplayMode
                Height: =32
                IsSearchable: =false
                Items: =Choices([@Pessoas].'ID Atividade')
                PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                SearchFields: =["uipp_atividade"]
                SearchItems: =[]
                SelectMultiple: =false
                Tooltip: =
                Visible: =false
                Width: =205
                ZIndex: =1

            SeparadorDependencias As rectangle:
                BorderColor: =cores.cinzento
                BorderStyle: =BorderStyle.Dashed
                BorderThickness: =0.5
                DisplayMode: =DisplayMode.View
                Fill: =cores.cinzento
                Height: =1
                OnSelect: =Select(Parent)
                Width: =Parent.TemplateWidth
                Y: =Parent.TemplateHeight - Self.Height
                ZIndex: =2

            "'Dependencias Observacoes' As text":
                BorderColor: =cores.cinzento
                Default: |-
                    =If(
                        formMode = FormMode.New,
                        Blank(),
                        ThisItem.Observações
                    )
                DelayOutput: =true
                DisplayMode: =Parent.DisplayMode
                Height: =89
                HintText: ="Observações"
                HoverBorderColor: =cores.cinzento
                HoverFill: =RGBA(255, 255, 255, 1)
                MaxLength: =100
                Mode: =TextMode.MultiLine
                OnChange: =
                PaddingLeft: =5
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =12
                Tooltip: ="Observações"
                Width: =505
                X: =393
                Y: =173
                ZIndex: =3

            "'Dependencias Informacao' As text":
                BorderColor: =cores.cinzento
                Default: |-
                    =If(
                        formMode = FormMode.New,
                        Blank(),
                        ThisItem.Informacao
                    )
                DelayOutput: =true
                DisplayMode: =Parent.DisplayMode
                Height: =89
                HintText: ="Informação de suporte"
                HoverBorderColor: =cores.cinzento
                HoverFill: =RGBA(255, 255, 255, 1)
                MaxLength: =100
                Mode: =TextMode.MultiLine
                OnChange: =
                PaddingLeft: =5
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =12
                Tooltip: ="Observações"
                Width: =505
                X: =393
                Y: =40
                ZIndex: =4

            "'Dependencias Remove' As icon.Add":
                Color: =cores.cinzento
                Height: =30
                Icon: =Icon.Trash
                OnSelect: |-
                    =Select(Parent);
                    RemoveIf(
                        collectDependencias,
                        ThisRecord.row = ThisItem.row
                    )
                Width: =30
                X: =900
                Y: =135
                ZIndex: =5

            "'Dependencias UO' As combobox":
                BorderColor: =cores.cinzento
                ChevronBackground: =cores.amareloMontepio
                ChevronHoverBackground: =ColorFade(cores.amareloMontepio, -20%)
                DefaultSelectedItems: |-
                    =If(
                        formMode = FormMode.New,
                        Blank(),
                        LookUp(
                            Choices([@Dependências].uipp_UnidadeOrganica),
                            ThisItem.Unidade.Unidade in ThisRecord.Unidade
                        )
                    )
                DisplayFields: =["uipp_unidade"]
                DisplayMode: =Parent.DisplayMode
                HoverBorderColor: =cores.cinzento
                HoverFill: =cores.amareloMontepio
                InputTextPlaceholder: ="Unidades Orgânicas"
                IsSearchable: =false
                Items: =Choices([@Dependências].uipp_UnidadeOrganica)
                NoSelectionText: ="Unidades Orgânicas"
                PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                PressedFill: =cores.amareloMontepio
                SearchFields: =["uipp_unidade"]
                SearchItems: =[]
                SelectionFill: =cores.amareloMontepio
                SelectMultiple: =false
                Tooltip: =
                Width: =368
                Y: =262
                ZIndex: =6

            "'Dependencias Tipo' As combobox":
                BorderColor: =cores.cinzento
                ChevronBackground: =cores.amareloMontepio
                ChevronHoverBackground: =ColorFade(cores.amareloMontepio, -20%)
                DefaultSelectedItems: |-
                    =If(
                        formMode = FormMode.New,
                        Blank(),
                        LookUp(
                            Choices('Tipo de Dependência'),
                            ThisItem.Tipo in Text(ThisRecord.Value)
                        )
                    )
                DisplayFields: =["Value"]
                DisplayMode: =Parent.DisplayMode
                HoverBorderColor: =cores.cinzento
                HoverFill: =cores.amareloMontepio
                InputTextPlaceholder: ="Tipo de Dependência"
                IsSearchable: =false
                Items: =Choices('Tipo de Dependência')
                NoSelectionText: ="Tipo de Dependência"
                PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                PressedFill: =cores.amareloMontepio
                SearchFields: =["Value"]
                SearchItems: =[]
                SelectionFill: =cores.amareloMontepio
                SelectMultiple: =false
                Width: =368
                Y: =188
                ZIndex: =7

            "'Dependencias Importancia' As combobox":
                BorderColor: =cores.cinzento
                ChevronBackground: =cores.amareloMontepio
                ChevronHoverBackground: =ColorFade(cores.amareloMontepio, -20%)
                DefaultSelectedItems: |-
                    =If(
                        formMode = FormMode.New,
                        Blank(),
                        LookUp(
                            Choices(Importância),
                            ThisItem.Importancia in Text(ThisRecord.Value)
                        )
                    )
                DisplayFields: =["Value"]
                DisplayMode: =Parent.DisplayMode
                HoverBorderColor: =cores.cinzento
                HoverFill: =cores.amareloMontepio
                InputTextPlaceholder: ="Importância"
                IsSearchable: =false
                Items: =Choices(Importância)
                NoSelectionText: ="Importância"
                PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                PressedFill: =cores.amareloMontepio
                SearchFields: =["Value"]
                SearchItems: =[]
                SelectionFill: =cores.amareloMontepio
                SelectMultiple: =false
                Tooltip: =
                Width: =176
                Y: =116
                ZIndex: =9

            "'Dependencias Entidades' As combobox":
                BorderColor: =cores.cinzento
                ChevronBackground: =cores.amareloMontepio
                ChevronHoverBackground: =ColorFade(cores.amareloMontepio, -20%)
                DefaultSelectedItems: |-
                    =If(
                        formMode = FormMode.New,
                        Blank(),
                        LookUp(
                            Choices([@Dependências].uipp_Entidades),
                            ThisItem.Entidade.Nome in ThisRecord.Nome
                        )
                    )
                DisplayFields: =["uipp_nome"]
                DisplayMode: =Parent.DisplayMode
                HoverBorderColor: =cores.cinzento
                HoverFill: =cores.amareloMontepio
                InputTextPlaceholder: ="Entidades"
                Items: =Choices([@Dependências].Entidades)
                PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                PressedFill: =cores.amareloMontepio
                SearchFields: =["uipp_nome"]
                SearchItems: =Search(Choices([@Dependências].Entidades),'Dependencias Entidades'.SearchText,"uipp_nome")
                SelectionFill: =cores.amareloMontepio
                SelectMultiple: =false
                Tooltip: =
                Width: =368
                Y: =40
                ZIndex: =10

            Label9_2 As label:
                Height: =17
                OnSelect: =Select(Parent)
                Text: |-
                    =If(
                        formMode = FormMode.New,
                        Blank(),
                        ThisItem.ID
                    )
                Visible: =false
                Width: =56
                X: =924
                Y: =198
                ZIndex: =11

            TextCanvas9 As Text:
                DisplayMode: =DisplayMode.Edit
                Height: =32
                Text: ="Unidade Orgância"
                Weight: ='TextCanvas.Weight'.Semibold
                Width: =147
                X: =0
                Y: =230
                ZIndex: =12

            TextCanvas9_1 As Text:
                DisplayMode: =DisplayMode.Edit
                Height: =32
                Text: ="Tipo de Dependência"
                Weight: ='TextCanvas.Weight'.Semibold
                Width: =147
                X: =0
                Y: =156
                ZIndex: =13

            TextCanvas9_2 As Text:
                DisplayMode: =DisplayMode.Edit
                Height: =32
                Text: ="Importância"
                Weight: ='TextCanvas.Weight'.Semibold
                Width: =147
                X: =0
                Y: =85
                ZIndex: =14

            TextCanvas9_3 As Text:
                DisplayMode: =DisplayMode.Edit
                Height: =36
                Text: ="Entidades"
                Weight: ='TextCanvas.Weight'.Semibold
                Width: =147
                X: =0
                Y: =4
                ZIndex: =15

            TextCanvas9_4 As Text:
                DisplayMode: =DisplayMode.Edit
                Height: =32
                Text: ="Dependência Informação"
                Weight: ='TextCanvas.Weight'.Semibold
                Width: =198
                X: =395
                Y: =4
                ZIndex: =16

            TextCanvas9_5 As Text:
                DisplayMode: =DisplayMode.Edit
                Height: =32
                Text: ="Dependência Observações"
                Weight: ='TextCanvas.Weight'.Semibold
                Width: =198
                X: =393
                Y: =129
                ZIndex: =17

        AddDependenciaBTN As groupContainer:
            Height: =40
            Visible: |-
                =(
                    Value('4Horas'.Text) = 4 Or
                    Value('24Horas'.Text) = 4 Or
                    Value('48Horas'.Text) = 4 Or
                    Value('1Semana'.Text) = 4 Or
                    Value('2Semanas'.Text) = 4 Or
                    Value('1Mes'.Text) = 4
                )
                And
                Trim(Lower('Passos do Registo de Atividade'.Selected.titulo)) = Trim(Lower("Dependências"))
            Width: =198
            X: =713
            Y: =655
            ZIndex: =21

            DynamicBtn_8 As DynamicBtn:
                BtnText: ="Adic. Depend."
                BtnWidth: =200
                Height: =40
                Visible: =true
                Width: =201
                ZIndex: =1

            "'Add dependencia' As button":
                AutoDisableOnSelect: =false
                BorderColor: =Color.Transparent
                DisabledBorderColor: =Color.Transparent
                DisabledFill: =Color.Transparent
                Fill: =Color.Transparent
                HoverBorderColor: =Color.Transparent
                HoverFill: =Color.Transparent
                OnSelect: |-
                    =Collect(collectDependencias, {row: Last(collectDependencias).row + 1})
                PressedFill: =Color.Transparent
                Size: =13
                Text: =""
                Width: =201
                ZIndex: =2

    Modal As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =26

        ModalConfirmation_1 As ModalConfirmation:
            ModalIcon: =Icon.Warning
            ModalIconColor: =cores.amareloMontepio
            ModalText: ="Deseja submeter os dados da Atividade " & DataCardValue3.Text & "?"
            Visible: =ModalForm.visible
            ZIndex: =28

        BtnModalConfirm As button:
            Color: =Color.Transparent
            Fill: =Color.Transparent
            HoverColor: =Color.Transparent
            HoverFill: =Color.Transparent
            OnSelect: |+
                =
                // Submeter Caracterização do Processo
                SubmitForm('Caracterizacao do Processo');
                Set(
                    LastAtividadeId,
                    'Caracterizacao do Processo'.LastSubmit.ID
                    //1005
                );
                
                    // Submeter Criticidade do Processo
                    ForAll(
                        Gallery2.AllItems,
                            Patch(
                                'Fatores de Criticidades',
                                If(
                                    formMode = FormMode.Edit,
                                    With(
                                        {record : ThisRecord.Label3.Text},
                                        LookUp(
                                            'Fatores de Criticidades',
                                            ThisRecord.ID = record
                                        )
                                    ),
                                    Defaults('Fatores de Criticidades')
                                ),
                                {
                                    'Tipo de Fator': ThisRecord.Dropdown2.Selected.Value,
                                    'quatro horas': Value(ThisRecord.'4horas'.Text),
                                    'vinte quatro horas': ThisRecord.'24horas'.Text,
                                    'quarenta oito horas': Value(ThisRecord.'48horas'.Text),
                                    'uma semana': Value(ThisRecord.'1semana'.Text),
                                    'duas semanas': Value(ThisRecord.'2semanas'.Text),
                                    'um mes': Value(ThisRecord.'1mes'.Text),
                                    'ID Atividade': LookUp(
                                        Atividades,
                                        ThisRecord.ID = LastAtividadeId
                                    ),
                                    Racional: ThisRecord.racional.Text
                                }
                            )
                    );
                    
                    // Submeter RTO
                    Patch(
                            RTOS,
                            If(
                                    formMode = FormMode.Edit,
                                    LookUp(
                                        RTOS,
                                        ThisRecord.ID = Label8.Text
                                    ),
                                    Defaults(RTOS)
                                ),
                            {
                                Atividade: LookUp(
                                    Atividades,
                                    ThisRecord.ID = LastAtividadeId
                                ),
                                Classificação: 'RTO label'.Text
                            }
                        );
                    
                    If(
                        Value('4Horas'.Text) = 4 Or Value('24Horas'.Text) = 4 Or Value('48Horas'.Text) = 4 Or Value('1Semana'.Text) = 4 Or Value('2Semanas'.Text) = 4 Or Value('1Mes'.Text) = 4,
                    
                        // Submeter Recursos
                        ForAll(
                            'Caracterização dos recursos'.AllItems,
                                Patch(
                                    Pessoas,
                                    If(
                                        formMode = FormMode.Edit,
                                        With(
                                            {record : ThisRecord.Label6.Text},
                                            LookUp(
                                                Pessoas,
                                                ThisRecord.ID = record
                                            )
                                        ),
                                        Defaults(Pessoas)
                                    ),
                                    {
                                        'Nº Empregado': ThisRecord.NumEmpregado.Text,
                                        'Colaborador Crítico': ThisRecord.Critico.Text,
                                        Teletrabalho: ThisRecord.Teletrabalho.Selected.Value,
                                        Tipo: ThisRecord.Tipo.Selected,
                                        Duração: ThisRecord.Duracao.Selected.Value,
                                        Observações: ThisRecord.Critico_1.Text,
                                        'ID Atividade': LookUp(
                                            Atividades,
                                            ThisRecord.ID = LastAtividadeId
                                        )
                                    }
                                )
                        );
                        
                        // Submeter Equipamentos
                        ForAll(
                            'Caracterização dos equipamentos'.AllItems,
                                Patch(
                                    'Equipamentos de Escritório',
                                    If(
                                        formMode = FormMode.Edit,
                                        With(
                                            {record : ThisRecord.Label9.Text},
                                            LookUp(
                                                'Equipamentos de Escritório',
                                                ThisRecord.ID = record
                                            )
                                        ),
                                        Defaults('Equipamentos de Escritório')
                                    ),
                                    {
                                        Equipamento: ThisRecord.Equipamento.Selected,
                                        Duração: ThisRecord.'Equipamento Duracao'.Selected.Value,
                                        Observações: ThisRecord.'Equipamento Obs'.Text,
                                        'ID Atividade': LookUp(
                                            Atividades,
                                            ThisRecord.ID = LastAtividadeId
                                        )
                                    }
                                )
                        );
                        
                        // Submeter Sistemas/Aplicações
                        ForAll(
                            'Caracterização dos sistemas'.AllItems,
                                Patch(
                                    Sistemas,
                                    If(
                                        formMode = FormMode.Edit,
                                        With(
                                            {record : ThisRecord.Label9_1.Text},
                                            LookUp(
                                                Sistemas,
                                                ThisRecord.ID = record
                                            )
                                        ),
                                        Defaults(Sistemas)
                                    ),
                                    {
                                        'Sistemas/Aplicações': ThisRecord.Sistema.Selected,
                                        Duração: ThisRecord.'Sistemas Duracao'.Selected.Value,
                                        Descrição: ThisRecord.'Sistemas Descrição'.Text,
                                        Observações: ThisRecord.'Sistemas Obs'.Text,
                                        'ID Atividade': LookUp(
                                            Atividades,
                                            ThisRecord.ID = LastAtividadeId
                                        )
                                    }
                                )
                        );
                        
                        // Submeter Dependências
                        ForAll(
                            'Caracterização das dependencias'.AllItems,
                                Patch(
                                    Dependências,
                                    If(
                                        formMode = FormMode.Edit,
                                        With(
                                            {record : ThisRecord.Label9_2.Text},
                                            LookUp(
                                                Dependências,
                                                ThisRecord.ID = record
                                            )
                                        ),
                                        Defaults(Dependências)
                                    ),
                                    {
                                        Entidades: ThisRecord.'Dependencias Entidades'.Selected,
                                        Importância: ThisRecord.'Dependencias Importancia'.Selected.Value,
                                        'Tipo de Dependência': ThisRecord.'Dependencias Tipo'.Selected.Value,
                                        'Unidade Orgânica': ThisRecord.'Dependencias UO'.Selected,
                                        'Informação de Suporte': ThisRecord.'Dependencias Informacao'.Text,
                                        Observações: ThisRecord.'Dependencias Observacoes'.Text,
                                        'ID Atividade': LookUp(
                                            Atividades,
                                            ThisRecord.ID = LastAtividadeId
                                        )
                                    }
                                )
                        )
                    );
                
                If(
                    IsEmpty(Errors('Fatores de Criticidades'))
                    And
                    IsEmpty(Errors(RTOS))
                    And
                    IsEmpty(Errors(Pessoas))
                    And
                    IsEmpty(Errors(Equipamentos))
                    And
                    IsEmpty(Errors('Sistemas/Aplicações'))
                    And
                    IsEmpty(Errors(Dependências)),
                
                    //em caso de sucesso
                    Patch(
                        'Histórico de aprovações',
                        Defaults('Histórico de aprovações'),
                        {
                            Estado:
                                LookUp(
                                    Atividades,
                                    ThisRecord.ID = LastAtividadeId
                                ).Estado,
                            'ID Atividade':
                                LookUp(
                                    Atividades,
                                    ThisRecord.ID = LastAtividadeId
                                )
                        }
                    );
                    Notify("Dados submetidos com sucesso!", NotificationType.Success, 4000);
                    Concurrent(
                        UpdateContext({ RTO: 0, RTOTempo: "<24 horas" }),
                        ResetForm('Caracterizacao do Processo');
                        ClearCollect(collectRecursos, Blank());
                        ClearCollect(collectEquipamentos, Blank());
                        ClearCollect(collectDependencias, Blank());
                        ClearCollect(collectSistemas, Blank())
                    );
                    Back(),
                    
                    Notify(
                        Concat(Errors('Fatores de Criticidades'), Column&": "&Message) & "
                            " & Concat(Errors(RTOS), Column&": "&Message) & "
                            " & Concat(Errors(Pessoas), Column&": "&Message) & "
                            " & Concat(Errors(Equipamentos), Column&": "&Message) & "
                            " & Concat(Errors('Sistemas/Aplicações'), Column&": "&Message) & "
                            " & Concat(Errors(Dependências), Column&": "&Message)
                        ,
                        NotificationType.Success,
                        4000
                    )
                )
                
                
            PressedColor: =Color.Transparent
            PressedFill: =Color.Transparent
            Text: =""
            Visible: =ModalForm.visible
            Width: =164
            X: =486
            Y: =440
            ZIndex: =29

        BtnModalCancel As button:
            Color: =Color.Transparent
            Fill: =Color.Transparent
            HoverColor: =Color.Transparent
            HoverFill: =Color.Transparent
            OnSelect: |-
                =UpdateContext({
                    ModalForm: {visible: false}
                })
            PressedColor: =Color.Transparent
            PressedFill: =Color.Transparent
            Text: =""
            Visible: =ModalForm.visible
            Width: =164
            X: =718
            Y: =440
            ZIndex: =30

    AproveReject As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =30

        ApproveBtn As DynamicBtn:
            BtnText: ="Aprovar"
            BtnWidth: =200
            ButtonIcon: =Icon.Check
            Height: =40
            Visible: |-
                =(AtividadeRecord.Estado = 'Estado Processo'.'Em validação' Or AtividadeRecord.Estado = 'Estado Processo'.'Em revalidação') And currentUser = "DRI"
                And
                Trim(Lower('Passos do Registo de Atividade'.Selected.titulo)) = Trim(Lower("Caracterização do Processo"))
            Width: =201
            X: =913
            Y: =695
            ZIndex: =24

        ApproveBtnCode As button:
            Color: =Color.Transparent
            Fill: =Color.Transparent
            HoverColor: =Color.Transparent
            HoverFill: =Color.Transparent
            OnSelect: |
                =UpdateContext(
                    {
                        ApproveForm: {
                            visible: true,
                            texto: "Deseja APROVAR a atividade " & DataCardValue3.Text & " ?"
                        }
                    }
                )
            PressedColor: =Color.Transparent
            PressedFill: =Color.Transparent
            Text: ="Aprovar"
            Visible: |-
                =(AtividadeRecord.Estado = 'Estado Processo'.'Em validação' Or AtividadeRecord.Estado = 'Estado Processo'.'Em revalidação') And currentUser = "DRI"
                And
                Trim(Lower('Passos do Registo de Atividade'.Selected.titulo)) = Trim(Lower("Caracterização do Processo"))
            Width: =201
            X: =904
            Y: =695
            ZIndex: =25

        RejectBtn As DynamicBtn:
            BtnText: ="Rejeitar"
            BtnWidth: =200
            ButtonIcon: =Icon.Cancel
            Height: =40
            Visible: |-
                =(AtividadeRecord.Estado = 'Estado Processo'.'Em validação' Or AtividadeRecord.Estado = 'Estado Processo'.'Em revalidação') And currentUser = "DRI"
                And
                Trim(Lower('Passos do Registo de Atividade'.Selected.titulo)) = Trim(Lower("Caracterização do Processo"))
            Width: =201
            X: =1126
            Y: =695
            ZIndex: =26

        RejectBtnCode As button:
            Color: =Color.Transparent
            Fill: =Color.Transparent
            HoverColor: =Color.Transparent
            HoverFill: =Color.Transparent
            OnSelect: |-
                =UpdateContext({
                    ApproveForm: {
                        visible: true,
                        texto: "Deseja REJEITAR a atividade " & DataCardValue3.Text & " ?"
                    }
                });
            PressedColor: =Color.Transparent
            PressedFill: =Color.Transparent
            Text: ="Rejeitar"
            Visible: |-
                =(AtividadeRecord.Estado = 'Estado Processo'.'Em validação' Or AtividadeRecord.Estado = 'Estado Processo'.'Em revalidação') And currentUser = "DRI"
                And
                Trim(Lower('Passos do Registo de Atividade'.Selected.titulo)) = Trim(Lower("Caracterização do Processo"))
            Width: =201
            X: =1126
            Y: =695
            ZIndex: =27

    ApproveModal As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =33

        ModalConfirmation_2 As ModalConfirmation:
            Height: =768
            ModalIcon: =Icon.Warning
            ModalIconColor: =cores.amareloMontepio
            ModalText: =ApproveForm.texto
            Visible: |-
                =If(
                    ApproveForm.visible,
                    true,
                    false
                )
            Width: =1366
            ZIndex: =31

        BtnModalConfirm_1 As button:
            Color: =Color.Transparent
            Fill: =Color.Transparent
            HoverColor: =Color.Transparent
            HoverFill: =Color.Transparent
            OnSelect: |-
                =If(
                    Trim(Lower("Aprovar")) in Trim(Lower(ApproveForm.texto)),
                
                    //Escrever no Histórico de Aprovações - APROVADO
                    Patch(
                        'Histórico de aprovações',
                        Defaults('Histórico de aprovações'),
                        {
                            Estado:'Estado Processo'.Aprovado,
                            'ID Atividade':
                                LookUp(
                                    Atividades,
                                    ThisRecord.ID = 'Gallery Data'.Selected.ID
                                )
                        }
                    );
                    //Atualizar o estado da Atividade - APROVADO
                    Patch(
                        Atividades,
                        LookUp(
                            Atividades,
                            ThisRecord.ID = 'Gallery Data'.Selected.ID
                        ),
                        {
                            Estado:'Estado Processo'.Aprovado
                        }
                    );
                    'GCN-Respostaaopedido'.Run(
                        'Gallery Data'.Selected.Atividade,
                        User().Email,
                        "APROVADO"
                    );
                    Back();
                    Notify("Atividade " & 'Gallery Data'.Selected.Atividade & " aprovada!", NotificationType.Success, 4000),
                
                    //Escrever no Histórico de Aprovações - REJEITADO
                    Patch(
                        'Histórico de aprovações',
                        Defaults('Histórico de aprovações'),
                        {
                            Estado:'Estado Processo'.Rejeitado,
                            'ID Atividade':
                                LookUp(
                                    Atividades,
                                    ThisRecord.ID = 'Gallery Data'.Selected.ID
                                )
                        }
                    );
                    //Atualizar o estado da Atividade - Rejeitado
                    Patch(
                        Atividades,
                        LookUp(
                            Atividades,
                            ThisRecord.ID = 'Gallery Data'.Selected.ID
                        ),
                        {
                            Estado:'Estado Processo'.Rejeitado
                        }
                    );
                    'GCN-Respostaaopedido'.Run(
                        'Gallery Data'.Selected.Atividade,
                        User().Email,
                        "REJEITADO"
                    );
                    Back();
                    Notify("Atividade " & 'Gallery Data'.Selected.Atividade & " rejeitada!", NotificationType.Success, 4000)
                )
            PressedColor: =Color.Transparent
            PressedFill: =Color.Transparent
            Text: =""
            Visible: =ApproveForm.visible
            Width: =164
            X: =488
            Y: =440
            ZIndex: =32

        BtnModalCancel_1 As button:
            Color: =Color.Transparent
            Fill: =Color.Transparent
            HoverColor: =Color.Transparent
            HoverFill: =Color.Transparent
            OnSelect: |-
                =UpdateContext({
                    ApproveForm: {visible: false}
                })
            PressedColor: =Color.Transparent
            PressedFill: =Color.Transparent
            Text: =""
            Visible: =ApproveForm.visible
            Width: =164
            X: =716
            Y: =440
            ZIndex: =33

    FatoresHeaders As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =51

        Label3_5 As label:
            Align: =Align.Center
            FontWeight: =FontWeight.Semibold
            Text: ="<4 horas"
            Visible: =Trim(Lower('Passos do Registo de Atividade'.Selected.titulo)) = Trim(Lower("Fatores de Criticidade"))
            Width: =110
            X: =434
            Y: =160
            ZIndex: =4

        Label3_6 As label:
            Align: =Align.Center
            FontWeight: =FontWeight.Semibold
            Text: ="<24 horas"
            Visible: =Trim(Lower('Passos do Registo de Atividade'.Selected.titulo)) = Trim(Lower("Fatores de Criticidade"))
            Width: =110
            X: =544
            Y: =160
            ZIndex: =5

        Label3_7 As label:
            Align: =Align.Center
            FontWeight: =FontWeight.Semibold
            Text: ="<48 horas"
            Visible: =Trim(Lower('Passos do Registo de Atividade'.Selected.titulo)) = Trim(Lower("Fatores de Criticidade"))
            Width: =110
            X: =654
            Y: =160
            ZIndex: =6

        Label3_8 As label:
            Align: =Align.Center
            FontWeight: =FontWeight.Semibold
            Text: ="<1 semana"
            Visible: =Trim(Lower('Passos do Registo de Atividade'.Selected.titulo)) = Trim(Lower("Fatores de Criticidade"))
            Width: =110
            X: =764
            Y: =160
            ZIndex: =7

        Label3_9 As label:
            Align: =Align.Center
            FontWeight: =FontWeight.Semibold
            Text: ="<2 semanas"
            Visible: =Trim(Lower('Passos do Registo de Atividade'.Selected.titulo)) = Trim(Lower("Fatores de Criticidade"))
            Width: =110
            X: =874
            Y: =160
            ZIndex: =8

        Label3_10 As label:
            Align: =Align.Center
            FontWeight: =FontWeight.Semibold
            Text: ="<1 mês"
            Visible: =Trim(Lower('Passos do Registo de Atividade'.Selected.titulo)) = Trim(Lower("Fatores de Criticidade"))
            Width: =110
            X: =984
            Y: =160
            ZIndex: =9

