"'Atividade Form Screen_1' As screen":
    OnVisible: |+
        =ClearCollect(
            AtividadeFormMenu,
            Table(
            //Excel 02
                {
                    titulo: "Caracterização do Processo",
                    estado: "em curso",
                    modo: DisplayMode.Edit
                },
                {
                    titulo: "Fatores de Criticidade",
                    estado: "em falta",
                    modo: DisplayMode.Edit
                },
            //Excel 03
                {
                    titulo: "Caracterização dos Recursos",
                    estado: "em falta",
                    modo: DisplayMode.Disabled
                },
            //Excel 04
                {
                    titulo: "Caracterização dos Equipamentos",
                    estado: "em falta",
                    modo: DisplayMode.Disabled
                },
            //Excel 05
                {
                    titulo: "Caracterização dos Sistemas",
                    estado: "em falta",
                    modo: DisplayMode.Disabled
                },
            //Excel 06
                {
                    titulo: "Dependências",
                    estado: "em falta",
                    modo: DisplayMode.Disabled
                }
            )
        )
        
        

    LeftSectionComponent_5 As LeftSectionComponent:
        ZIndex: =1

    "'Caracterizacao do Processo_1' As form":
        DataSource: =Atividades
        DefaultMode: |-
            =If(
                formMode = 1,
                FormMode.New,
                FormMode.Edit
            )
        Height: =385
        Item: =Blank()
        Visible: =Trim(Lower('Passos do Registo de Atividade_1'.Selected.titulo)) = Trim(Lower("Caracterização do Processo"))
        Width: =990
        X: =360
        Y: =224
        ZIndex: =3

        "'Tipo de Processo_DataCard1_1' As typedDataCard.comboBoxEditCard":
            BorderStyle: =BorderStyle.Solid
            DataField: ="uipp_TipodeProcesso"
            Default: =ThisItem.'Tipo de Processo'
            DisplayMode: =Parent.DisplayMode
            DisplayName: =DataSourceInfo([@Atividades],DataSourceInfo.DisplayName,"uipp_TipodeProcesso")
            Fill: =RGBA(0, 0, 0, 0)
            Height: =50
            Required: =true
            Update: =DataCardValue11_1.Selected
            Width: =329
            X: =0
            Y: =0
            ZIndex: =1

            DataCardKey12_1 As label:
                AutoHeight: =true
                Color: =cores.cinzento
                Height: =34
                Text: =Parent.DisplayName
                Width: =Parent.Width - 60
                Wrap: =false
                X: =30
                Y: =10
                ZIndex: =1

            DataCardValue11_1 As combobox:
                BorderColor: =If(IsBlank(Parent.Error), cores.cinzento, Color.Red)
                ChevronBackground: =cores.amareloMontepio
                ChevronHoverBackground: =cores.amareloMontepio
                DefaultSelectedItems: =Parent.Default
                DisplayFields: =["uipp_tipodeprocesso"]
                DisplayMode: =Parent.DisplayMode
                HoverBorderColor: =cores.cinzento
                HoverFill: =cores.amareloMontepio
                Items: =Choices([@Atividades].'Tipo de Processo')
                OnChange: |-
                    =If(
                        !IsBlank(DataCardValue11_1.Selected) And !IsBlank(DataCardValue8_1.Selected) And !IsBlank(DataCardValue10_1.Selected) And !IsBlank(DataCardValue3_1.Text),
                        Patch(
                            AtividadeFormMenu,
                            LookUp(
                                AtividadeFormMenu,
                                Trim(Lower(ThisRecord.titulo)) = Trim(Lower("Caracterização do Processo"))
                            ),
                            {
                                estado: "feito"
                            }
                        )
                    )
                PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                PressedFill: =cores.amareloMontepio
                SearchFields: =["uipp_tipodeprocesso"]
                SearchItems: =Search(Choices([@Atividades].'Tipo de Processo'),DataCardValue11_1.SearchText,"uipp_tipodeprocesso")
                SelectionFill: =cores.amareloMontepio
                SelectMultiple: =false
                Tooltip: =Parent.DisplayName
                Width: =Parent.Width - 60
                X: =30
                Y: =54
                ZIndex: =2

            ErrorMessage10_1 As label:
                AutoHeight: =true
                Height: =10
                Live: =Live.Assertive
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =Parent.Error
                Visible: =Parent.DisplayMode=DisplayMode.Edit
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardValue11_1.Y + DataCardValue11_1.Height
                ZIndex: =3

            StarVisible10_3 As label:
                Align: =Align.Center
                Color: =Color.Red
                Height: =DataCardKey12_1.Height
                Text: ="*"
                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                Width: =30
                Wrap: =false
                Y: =DataCardKey12_1.Y
                ZIndex: =4

        "'Macro Processo_DataCard1_1' As typedDataCard.comboBoxEditCard":
            BorderStyle: =BorderStyle.Solid
            DataField: ="uipp_MacroProcesso"
            Default: =ThisItem.'Macro Processo'
            DisplayMode: =Parent.DisplayMode
            DisplayName: =DataSourceInfo([@Atividades],DataSourceInfo.DisplayName,"uipp_MacroProcesso")
            Fill: =RGBA(0, 0, 0, 0)
            Height: =50
            Required: =true
            Update: =DataCardValue8_1.Selected
            Visible: =true
            Width: =329
            X: =1
            Y: =0
            ZIndex: =1

            DataCardKey9_1 As label:
                AutoHeight: =true
                Color: =cores.cinzento
                Height: =34
                Text: =Parent.DisplayName
                Width: =Parent.Width - 60
                Wrap: =false
                X: =30
                Y: =10
                ZIndex: =1

            DataCardValue8_1 As combobox:
                BorderColor: =If(IsBlank(Parent.Error), cores.cinzento, Color.Red)
                ChevronBackground: =cores.amareloMontepio
                ChevronHoverBackground: =cores.amareloMontepio
                DefaultSelectedItems: =Parent.Default
                DisplayFields: =["uipp_macroprocesso"]
                DisplayMode: =Parent.DisplayMode
                HoverBorderColor: =cores.cinzento
                HoverFill: =cores.amareloMontepio
                Items: =Choices([@Atividades].'Macro Processo')
                OnChange: |-
                    =If(
                        !IsBlank(DataCardValue11_1.Selected) And !IsBlank(DataCardValue8_1.Selected) And !IsBlank(DataCardValue10_1.Selected) And !IsBlank(DataCardValue3_1.Text),
                        Patch(
                            AtividadeFormMenu,
                            LookUp(
                                AtividadeFormMenu,
                                Trim(Lower(ThisRecord.titulo)) = Trim(Lower("Caracterização do Processo"))
                            ),
                            {
                                estado: "feito"
                            }
                        )
                    )
                PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                PressedFill: =cores.amareloMontepio
                SearchFields: =["uipp_macroprocesso"]
                SearchItems: =Search(Choices([@Atividades].'Macro Processo'),DataCardValue8_1.SearchText,"uipp_macroprocesso")
                SelectionFill: =cores.amareloMontepio
                SelectMultiple: =false
                Tooltip: =Parent.DisplayName
                Width: =Parent.Width - 60
                X: =30
                Y: =54
                ZIndex: =2

            ErrorMessage7_1 As label:
                AutoHeight: =true
                Height: =10
                Live: =Live.Assertive
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =Parent.Error
                Visible: =Parent.DisplayMode=DisplayMode.Edit
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardValue8_1.Y + DataCardValue8_1.Height
                ZIndex: =3

            StarVisible7_1 As label:
                Align: =Align.Center
                Color: =Color.Red
                Height: =DataCardKey9_1.Height
                Text: ="*"
                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                Width: =30
                Wrap: =false
                Y: =DataCardKey9_1.Y
                ZIndex: =4

        Processo_DataCard1_1 As typedDataCard.comboBoxEditCard:
            BorderStyle: =BorderStyle.Solid
            DataField: ="uipp_Processo"
            Default: =ThisItem.Processo
            DisplayMode: =Parent.DisplayMode
            DisplayName: =DataSourceInfo([@Atividades],DataSourceInfo.DisplayName,"uipp_Processo")
            Fill: =RGBA(0, 0, 0, 0)
            Height: =50
            Required: =true
            Update: =DataCardValue10_1.Selected
            Width: =329
            X: =2
            Y: =0
            ZIndex: =1

            DataCardKey11_1 As label:
                AutoHeight: =true
                Color: =cores.cinzento
                Height: =34
                Text: =Parent.DisplayName
                Width: =Parent.Width - 60
                Wrap: =false
                X: =30
                Y: =10
                ZIndex: =1

            DataCardValue10_1 As combobox:
                BorderColor: =If(IsBlank(Parent.Error), cores.cinzento, Color.Red)
                ChevronBackground: =cores.amareloMontepio
                ChevronHoverBackground: =cores.amareloMontepio
                DefaultSelectedItems: =Parent.Default
                DisplayFields: =["uipp_processo"]
                DisplayMode: =Parent.DisplayMode
                HoverBorderColor: =cores.cinzento
                HoverFill: =cores.amareloMontepio
                Items: =Choices([@Atividades].Processo)
                OnChange: |-
                    =If(
                        !IsBlank(DataCardValue11_1.Selected) And !IsBlank(DataCardValue8_1.Selected) And !IsBlank(DataCardValue10_1.Selected) And !IsBlank(DataCardValue3_1.Text),
                        Patch(
                            AtividadeFormMenu,
                            LookUp(
                                AtividadeFormMenu,
                                Trim(Lower(ThisRecord.titulo)) = Trim(Lower("Caracterização do Processo"))
                            ),
                            {
                                estado: "feito"
                            }
                        )
                    )
                PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                PressedFill: =cores.amareloMontepio
                SearchFields: =["uipp_processo"]
                SearchItems: =Search(Choices([@Atividades].Processo),DataCardValue10_1.SearchText,"uipp_processo")
                SelectionFill: =cores.amareloMontepio
                SelectMultiple: =false
                Tooltip: =Parent.DisplayName
                Width: =Parent.Width - 60
                X: =30
                Y: =54
                ZIndex: =2

            ErrorMessage9_1 As label:
                AutoHeight: =true
                Height: =10
                Live: =Live.Assertive
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =Parent.Error
                Visible: =Parent.DisplayMode=DisplayMode.Edit
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardValue10_1.Y + DataCardValue10_1.Height
                ZIndex: =3

            StarVisible9_1 As label:
                Align: =Align.Center
                Color: =Color.Red
                Height: =DataCardKey11_1.Height
                Text: ="*"
                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                Width: =30
                Wrap: =false
                Y: =DataCardKey11_1.Y
                ZIndex: =4

        Atividade_DataCard1_1 As typedDataCard.textualMultiLineEditCard:
            BorderStyle: =BorderStyle.Solid
            DataField: ="uipp_atividade"
            Default: =ThisItem.Atividade
            DisplayMode: =Parent.DisplayMode
            DisplayName: =DataSourceInfo([@Atividades],DataSourceInfo.DisplayName,"uipp_atividade")
            Fill: =RGBA(0, 0, 0, 0)
            Height: =50
            Required: =true
            Update: =DataCardValue3_1.Text
            Width: =660
            WidthFit: =false
            X: =0
            Y: =1
            ZIndex: =1

            DataCardKey3_1 As label:
                AutoHeight: =true
                Color: =cores.cinzento
                Height: =34
                Text: =Parent.DisplayName
                Width: =Parent.Width - 60
                Wrap: =false
                X: =30
                Y: =10
                ZIndex: =1

            DataCardValue3_1 As text:
                BorderColor: =If(IsBlank(Parent.Error), cores.cinzento, Color.Red)
                Default: =Parent.Default
                DelayOutput: =true
                DisplayMode: =Parent.DisplayMode
                Height: =80
                HoverBorderColor: =cores.cinzento
                HoverFill: =RGBA(255, 255, 255, 1)
                Mode: =TextMode.MultiLine
                OnChange: |-
                    =If(
                        !IsBlank(DataCardValue11_1.Selected) And !IsBlank(DataCardValue8_1.Selected) And !IsBlank(DataCardValue10_1.Selected) And !IsBlank(DataCardValue3_1.Text),
                        Patch(
                            AtividadeFormMenu,
                            LookUp(
                                AtividadeFormMenu,
                                Trim(Lower(ThisRecord.titulo)) = Trim(Lower("Caracterização do Processo"))
                            ),
                            {
                                estado: "feito"
                            }
                        )
                    )
                PaddingLeft: =5
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Tooltip: =Parent.DisplayName
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardKey3_1.Y + DataCardKey3_1.Height + 5
                ZIndex: =2

            ErrorMessage1_1 As label:
                AutoHeight: =true
                Height: =10
                Live: =Live.Assertive
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =Parent.Error
                Visible: =Parent.DisplayMode=DisplayMode.Edit
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardValue3_1.Y + DataCardValue3_1.Height
                ZIndex: =3

            StarVisible1_1 As label:
                Align: =Align.Center
                Color: =Color.Red
                Height: =DataCardKey3_1.Height
                Text: ="*"
                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                Width: =30
                Wrap: =false
                Y: =DataCardKey3_1.Y
                ZIndex: =4

        Edifício_DataCard1_1 As typedDataCard.comboBoxEditCard:
            BorderStyle: =BorderStyle.Solid
            DataField: ="uipp_Edificio"
            Default: =ThisItem.Edifício
            DisplayMode: =Parent.DisplayMode
            DisplayName: =DataSourceInfo([@Atividades],DataSourceInfo.DisplayName,"uipp_Edificio")
            Fill: =RGBA(0, 0, 0, 0)
            Height: =50
            Required: =false
            Update: =DataCardValue7_1.Selected
            Width: =329
            X: =2
            Y: =1
            ZIndex: =1

            DataCardKey8_1 As label:
                AutoHeight: =true
                Color: =cores.cinzento
                Height: =34
                Text: =Parent.DisplayName
                Width: =Parent.Width - 60
                Wrap: =false
                X: =30
                Y: =10
                ZIndex: =1

            DataCardValue7_1 As combobox:
                BorderColor: =If(IsBlank(Parent.Error), cores.cinzento, Color.Red)
                ChevronBackground: =cores.amareloMontepio
                ChevronHoverBackground: =cores.amareloMontepio
                DefaultSelectedItems: =Parent.Default
                DisplayFields: =["uipp_localizacao"]
                DisplayMode: =Parent.DisplayMode
                HoverBorderColor: =cores.cinzento
                HoverFill: =cores.amareloMontepio
                Items: =Choices([@Atividades].Edifício)
                PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                PressedFill: =cores.amareloMontepio
                SearchFields: =["uipp_localizacao"]
                SearchItems: =Search(Choices([@Atividades].Edifício),DataCardValue7_1.SearchText,"uipp_localizacao")
                SelectionFill: =cores.amareloMontepio
                SelectMultiple: =false
                Tooltip: =Parent.DisplayName
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardKey8_1.Y + DataCardKey8_1.Height + 5
                ZIndex: =2

            ErrorMessage6_1 As label:
                AutoHeight: =true
                Height: =10
                Live: =Live.Assertive
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =Parent.Error
                Visible: =Parent.DisplayMode=DisplayMode.Edit
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardValue7_1.Y + DataCardValue7_1.Height
                ZIndex: =3

            StarVisible6_1 As label:
                Align: =Align.Center
                Height: =DataCardKey8_1.Height
                Text: ="*"
                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                Width: =30
                Wrap: =false
                Y: =DataCardKey8_1.Y
                ZIndex: =4

        "'Descrição de atividade_DataCard1_1' As typedDataCard.textualMultiLineEditCard":
            BorderStyle: =BorderStyle.Solid
            DataField: ="uipp_descricaodeatividade"
            Default: =ThisItem.'Descrição de atividade'
            DisplayMode: =Parent.DisplayMode
            DisplayName: =DataSourceInfo([@Atividades],DataSourceInfo.DisplayName,"uipp_descricaodeatividade")
            Fill: =RGBA(0, 0, 0, 0)
            Height: =50
            Required: =false
            Update: =DataCardValue5_1.Text
            Width: =990
            WidthFit: =true
            X: =0
            Y: =2
            ZIndex: =1

            DataCardKey6_1 As label:
                AutoHeight: =true
                Color: =cores.cinzento
                Height: =34
                Text: =Parent.DisplayName
                Width: =Parent.Width - 60
                Wrap: =false
                X: =30
                Y: =10
                ZIndex: =1

            DataCardValue5_1 As text:
                BorderColor: =If(IsBlank(Parent.Error), cores.cinzento, Color.Red)
                Default: =Parent.Default
                DelayOutput: =true
                DisplayMode: =Parent.DisplayMode
                Height: =80
                HoverBorderColor: =cores.cinzento
                HoverFill: =RGBA(255, 255, 255, 1)
                Mode: =TextMode.MultiLine
                PaddingLeft: =5
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Tooltip: =Parent.DisplayName
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardKey6_1.Y + DataCardKey6_1.Height + 5
                ZIndex: =2

            ErrorMessage4_1 As label:
                AutoHeight: =true
                Height: =10
                Live: =Live.Assertive
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =Parent.Error
                Visible: =Parent.DisplayMode=DisplayMode.Edit
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardValue5_1.Y + DataCardValue5_1.Height
                ZIndex: =3

            StarVisible4_1 As label:
                Align: =Align.Center
                Height: =DataCardKey6_1.Height
                Text: ="*"
                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                Width: =30
                Wrap: =false
                Y: =DataCardKey6_1.Y
                ZIndex: =4

        Estado_DataCard1_1 As typedDataCard.comboBoxOptionSetSingleEditCard:
            BorderStyle: =BorderStyle.Solid
            DataField: ="uipp_estado"
            Default: =ThisItem.Estado
            DisplayMode: =Parent.DisplayMode
            DisplayName: =DataSourceInfo([@Atividades],DataSourceInfo.DisplayName,"uipp_estado")
            Fill: =RGBA(0, 0, 0, 0)
            Height: =50
            Required: =false
            Update: =DataCardValue6_1.Selected.Value
            Width: =329
            X: =0
            Y: =3
            ZIndex: =1

            DataCardKey7_1 As label:
                AutoHeight: =true
                Height: =34
                Text: =Parent.DisplayName
                Width: =Parent.Width - 60
                Wrap: =false
                ZIndex: =1

            DataCardValue6_1 As combobox:
                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                Default: |-
                    =LookUp(
                        Choices('Estado Processo'),
                        Text(ThisRecord.Value) = "Em preenchimento"
                    )
                DefaultSelectedItems: |-
                    =/*If(
                        IsBlank([Parent.Default]),
                        */LookUp(
                            Choices('Estado Processo'),
                            Text(ThisRecord.Value) = "Em preenchimento"
                        )/*,
                        [Parent.Default]
                    )*/
                DisplayFields: =["Value"]
                DisplayMode: =Parent.DisplayMode
                IsSearchable: =false
                Items: =Choices('Estado Processo')
                PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                SearchFields: =["Value"]
                SearchItems: =[]
                SelectMultiple: =false
                Tooltip: =Parent.DisplayName
                Width: =Parent.Width - 60
                Y: =21
                ZIndex: =2

            ErrorMessage5_1 As label:
                AutoHeight: =true
                Height: =10
                Live: =Live.Assertive
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =Parent.Error
                Visible: =Parent.DisplayMode=DisplayMode.Edit
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardValue6_1.Y + DataCardValue6_1.Height
                ZIndex: =3

            StarVisible5_1 As label:
                Align: =Align.Center
                Height: =DataCardKey7_1.Height
                Text: ="*"
                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                Width: =30
                Wrap: =false
                Y: =DataCardKey7_1.Y
                ZIndex: =4

        "'Unidade Orgânica_DataCard1_1' As typedDataCard.textualEditCard":
            BorderStyle: =BorderStyle.Solid
            DataField: ="uipp_unidadeorganica"
            Default: =ThisItem.'Unidade Orgânica'
            DisplayMode: =Parent.DisplayMode
            DisplayName: =DataSourceInfo([@Atividades],DataSourceInfo.DisplayName,"uipp_unidadeorganica")
            Fill: =RGBA(0, 0, 0, 0)
            Height: =50
            MaxLength: =DataSourceInfo([@Atividades], DataSourceInfo.MaxLength, "uipp_unidadeorganica")
            Required: =false
            Update: =DataCardValue12_1.Text
            Visible: =false
            Width: =329
            X: =1
            Y: =3
            ZIndex: =1

            DataCardKey13_1 As label:
                AutoHeight: =true
                Height: =34
                Text: =Parent.DisplayName
                Width: =Parent.Width - 60
                Wrap: =false
                X: =30
                Y: =10
                ZIndex: =1

            DataCardValue12_1 As text:
                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                Default: |-
                    =If(
                        IsBlank(Parent.Default),
                        currentUser,
                        Parent.Default
                    )
                DelayOutput: =true
                DisplayMode: =Parent.DisplayMode
                MaxLength: =Parent.MaxLength
                PaddingLeft: =5
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Tooltip: =Parent.DisplayName
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardKey13_1.Y + DataCardKey13_1.Height + 5
                ZIndex: =2

            ErrorMessage11_1 As label:
                AutoHeight: =true
                Height: =10
                Live: =Live.Assertive
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =Parent.Error
                Visible: =Parent.DisplayMode=DisplayMode.Edit
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardValue12_1.Y + DataCardValue12_1.Height
                ZIndex: =3

            StarVisible11_1 As label:
                Align: =Align.Center
                Height: =DataCardKey13_1.Height
                Text: ="*"
                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                Width: =30
                Wrap: =false
                Y: =DataCardKey13_1.Y
                ZIndex: =4

    "'Passos do Registo de Atividade_1' As gallery.'BrowseLayout_Horizontal_TwoTextOneImageVariant_ver5.0'":
        DelayItemLoading: =true
        Height: =61
        Items: =AtividadeFormMenu
        LoadingSpinner: =LoadingSpinner.Data
        TemplatePadding: =0
        TemplateSize: ='Passos do Registo de Atividade_1'.Width / 'Passos do Registo de Atividade_1'.AllItemsCount
        Width: =945
        X: =382
        Y: =91
        ZIndex: =6

        Label2_1 As label:
            Align: =Align.Center
            DisplayMode: =ThisItem.modo
            FontWeight: |-
                =If(
                    ThisItem.IsSelected,
                    FontWeight.Bold,
                    FontWeight.Normal
                )
            Height: =61
            OnSelect: |-
                =Select(Parent);
                If(
                    ThisItem.estado <> "feito",
                    Patch(
                        AtividadeFormMenu,
                        LookUp(
                            AtividadeFormMenu,
                            Trim(Lower(ThisRecord.titulo)) = Trim(Lower(ThisItem.titulo))
                        ),
                        {
                            estado: "em curso"
                        }
                    )
                )
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingTop: =0
            Size: =12
            Text: =ThisItem.titulo
            VerticalAlign: =VerticalAlign.Top
            Width: =Parent.Width / Parent.AllItemsCount
            ZIndex: =1

        Rectangle4_1 As rectangle:
            Fill: |-
                =Switch(
                    ThisItem.estado,
                    "em curso",
                    cores.amareloMontepio,
                    "em falta",
                    Color.Red,
                    "feito",
                    Color.Green
                )
            Height: =2
            OnSelect: =Select(Parent)
            Width: =Parent.Width / Parent.AllItemsCount
            Y: =47
            ZIndex: =2

    "'Atividade Form Header_1' As group":
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =13

        DynamicBtn_4 As DynamicBtn:
            BtnText: ="Guardar"
            BtnWidth: =200
            Height: =40
            Width: =201
            X: =1104
            Y: =35

        Label1_4 As label:
            Size: =15
            Text: |-
                ="Atividades > " &
                If(
                    formMode = FormMode.New,
                    "Criar registo de Atividade",
                    "Editar registo de Atividade"
                )
            Width: =610
            X: =359
            Y: =35
            ZIndex: =4

        Button3_1 As button:
            Color: =Color.Transparent
            Fill: =Color.Transparent
            HoverColor: =Color.Transparent
            HoverFill: =Color.Transparent
            OnSelect: |-
                =//SubmitForm('Caracterizacao do Processo');
                Set(
                    LastAtividadeId,
                    'Caracterizacao do Processo_1'.LastSubmit.ID
                );
                
                ForAll(
                    Gallery2_1.AllItems,
                    If(
                        !IsBlank(ThisRecord.4horas_1.Text) And
                        !IsBlank(First(Gallery2_1.AllItems).4horas_1.Text) And
                        If(
                            !IsBlank(First(Gallery2_1.AllItems).24horas_1.Text),
                            Value(First(Gallery2_1.AllItems).4horas_1.Text) <= Value(First(Gallery2_1.AllItems).24horas_1.Text),
                            true
                        ) And
                        If(
                            !IsBlank(First(Gallery2_1.AllItems).48horas_1.Text),
                            Value(First(Gallery2_1.AllItems).24horas_1.Text) <= Value(First(Gallery2_1.AllItems).48horas_1.Text),
                            true
                        ) And
                        If(
                            !IsBlank(First(Gallery2_1.AllItems).1semana_1.Text),
                            Value(First(Gallery2_1.AllItems).48horas_1.Text) <= Value(First(Gallery2_1.AllItems).1semana_1.Text),
                            true
                        ) And
                        If(
                            !IsBlank(First(Gallery2_1.AllItems).2semanas_1.Text),
                            Value(First(Gallery2_1.AllItems).1semana_1.Text) <= Value(First(Gallery2_1.AllItems).2semanas_1.Text),
                            true
                        )  And
                        If(
                            !IsBlank(First(Gallery2_1.AllItems).1mes_1.Text),
                            Value(First(Gallery2_1.AllItems).2semanas_1.Text) <= Value(First(Gallery2_1.AllItems).1mes_1.Text),
                            true
                        ),
                        Patch(
                            'Fatores de Criticidades',
                            Defaults('Fatores de Criticidades'),
                            {
                                'Tipo de Fator':
                                Switch(
                                    ThisRecord.Label5_1.Text,
                                    "Gestão",
                                    'Tipo de Fator'.Gestão,
                                    "Receitas",
                                    'Tipo de Fator'.Receitas,
                                    "Reputação",
                                    'Tipo de Fator'.Reputação,
                                    "Custo",
                                    'Tipo de Fator'.Custo,
                                    "Legal",
                                    'Tipo de Fator'.Legal
                                ),
                                'quatro horas': Value(ThisRecord.4horas_1.Text),
                                'vinte quatro horas': ThisRecord.24horas_1.Text,
                                'quarenta oito horas': Value(ThisRecord.48horas_1.Text),
                                'uma semana': Value(ThisRecord.1semana_1.Text),
                                'duas semanas': Value(ThisRecord.2semanas_1.Text),
                                'um mes': Value(ThisRecord.1mes_1.Text),
                                'ID Atividade': LookUp(Atividades, ThisRecord.ID = LastAtividadeId),
                                Racional: ThisRecord.racional_1.Text
                            }
                        ),
                        false
                    )
                )
            PressedColor: =Color.Transparent
            PressedFill: =Color.Transparent
            Text: ="Button"
            Width: =201
            X: =1104
            Y: =35
            ZIndex: =7

    "Gallery2_1 As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
        DelayItemLoading: =true
        Height: =495
        Items: =Choices('Tipo de Fator')
        Layout: =Layout.Vertical
        LoadingSpinner: =LoadingSpinner.Data
        TemplatePadding: =0
        TemplateSize: =96
        Visible: =Trim(Lower('Passos do Registo de Atividade_1'.Selected.titulo)) = Trim(Lower("Fatores de Criticidade"))
        Width: =990
        X: =360
        Y: =199
        ZIndex: =51

        Separator2_1 As rectangle:
            Height: =8
            OnSelect: =Select(Parent)
            Width: =Parent.TemplateWidth
            Y: =Parent.TemplateHeight - Self.Height
            ZIndex: =5

        Label5_1 As label:
            Height: =50
            OnSelect: =Select(Parent)
            Text: =ThisItem.Value
            Width: =130
            Y: =5
            ZIndex: =6

        "'4horas_1' As text":
            BorderColor: =cores.cinzento
            Default: =
            DelayOutput: =true
            Format: =TextFormat.Number
            HoverBorderColor: =cores.cinzento
            HoverFill: =
            PaddingLeft: =5
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Tooltip: =
            Visible: =Trim(Lower('Passos do Registo de Atividade_1'.Selected.titulo)) = Trim(Lower("Fatores de Criticidade"))
            Width: =50
            X: =106
            Y: =10
            ZIndex: =7

        "'24horas_1' As text":
            BorderColor: =cores.cinzento
            Default: = 
            DelayOutput: =true
            Format: =TextFormat.Number
            HoverBorderColor: =cores.cinzento
            HoverFill: =
            MaxLength: =1
            Mode: =TextFormat.Number
            PaddingLeft: =5
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Tooltip: =
            Visible: =Trim(Lower('Passos do Registo de Atividade_1'.Selected.titulo)) = Trim(Lower("Fatores de Criticidade"))
            Width: =50
            X: =216
            Y: =10
            ZIndex: =8

        "'48horas_1' As text":
            BorderColor: =cores.cinzento
            Default: = 
            DelayOutput: =true
            Format: =TextFormat.Number
            HoverBorderColor: =cores.cinzento
            HoverFill: =
            MaxLength: =1
            Mode: =TextFormat.Number
            PaddingLeft: =5
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Tooltip: =
            Visible: =Trim(Lower('Passos do Registo de Atividade_1'.Selected.titulo)) = Trim(Lower("Fatores de Criticidade"))
            Width: =50
            X: =326
            Y: =10
            ZIndex: =9

        "'1semana_1' As text":
            BorderColor: =cores.cinzento
            Default: = 
            DelayOutput: =true
            Format: =TextFormat.Number
            HoverBorderColor: =cores.cinzento
            HoverFill: =
            MaxLength: =1
            Mode: =TextFormat.Number
            PaddingLeft: =5
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Tooltip: =
            Visible: =Trim(Lower('Passos do Registo de Atividade_1'.Selected.titulo)) = Trim(Lower("Fatores de Criticidade"))
            Width: =50
            X: =436
            Y: =10
            ZIndex: =10

        "'2semanas_1' As text":
            BorderColor: =cores.cinzento
            Default: = 
            DelayOutput: =true
            Format: =TextFormat.Number
            HoverBorderColor: =cores.cinzento
            HoverFill: =
            MaxLength: =1
            Mode: =TextFormat.Number
            PaddingLeft: =5
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Tooltip: =
            Visible: =Trim(Lower('Passos do Registo de Atividade_1'.Selected.titulo)) = Trim(Lower("Fatores de Criticidade"))
            Width: =50
            X: =546
            Y: =10
            ZIndex: =11

        "'1mes_1' As text":
            BorderColor: =cores.cinzento
            Default: = 
            DelayOutput: =true
            Format: =TextFormat.Number
            HoverBorderColor: =cores.cinzento
            HoverFill: =
            MaxLength: =1
            Mode: =TextFormat.Number
            PaddingLeft: =5
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Tooltip: =
            Visible: =Trim(Lower('Passos do Registo de Atividade_1'.Selected.titulo)) = Trim(Lower("Fatores de Criticidade"))
            Width: =50
            X: =666
            Y: =10
            ZIndex: =12

        racional_1 As text:
            BorderColor: =cores.cinzento
            Default: = 
            DelayOutput: =true
            Height: =81
            HoverBorderColor: =cores.cinzento
            HoverFill: =
            MaxLength: =255
            Mode: =TextMode.MultiLine
            PaddingLeft: =5
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Tooltip: =
            Visible: =Trim(Lower('Passos do Registo de Atividade_1'.Selected.titulo)) = Trim(Lower("Fatores de Criticidade"))
            Width: =218
            X: =759
            Y: =10
            ZIndex: =13

        StarVisible10_2 As label:
            Align: =Align.Center
            Color: =Color.Red
            Height: =DataCardKey12_1.Height
            Text: ="*"
            Visible: |-
                =If(
                    Gallery2_1.DisplayMode = DisplayMode.Edit,
                    true,
                    false
                )
            Width: =25
            Wrap: =false
            X: =156
            ZIndex: =14

    FatoresHeaders_1 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =51

        Label3_12 As label:
            Align: =Align.Center
            Text: ="<4 horas"
            Visible: =Trim(Lower('Passos do Registo de Atividade_1'.Selected.titulo)) = Trim(Lower("Fatores de Criticidade"))
            Width: =110
            X: =434
            Y: =160
            ZIndex: =19

        Label3_13 As label:
            Align: =Align.Center
            Text: ="<24 horas"
            Visible: =Trim(Lower('Passos do Registo de Atividade_1'.Selected.titulo)) = Trim(Lower("Fatores de Criticidade"))
            Width: =110
            X: =544
            Y: =160
            ZIndex: =20

        Label3_14 As label:
            Align: =Align.Center
            Text: ="<48 horas"
            Visible: =Trim(Lower('Passos do Registo de Atividade_1'.Selected.titulo)) = Trim(Lower("Fatores de Criticidade"))
            Width: =110
            X: =654
            Y: =160
            ZIndex: =22

        Label3_15 As label:
            Align: =Align.Center
            Text: ="<1 semana"
            Visible: =Trim(Lower('Passos do Registo de Atividade_1'.Selected.titulo)) = Trim(Lower("Fatores de Criticidade"))
            Width: =110
            X: =764
            Y: =160
            ZIndex: =23

        Label3_16 As label:
            Align: =Align.Center
            Text: ="<2 semanas"
            Visible: =Trim(Lower('Passos do Registo de Atividade_1'.Selected.titulo)) = Trim(Lower("Fatores de Criticidade"))
            Width: =110
            X: =874
            Y: =160
            ZIndex: =24

        Label3_17 As label:
            Align: =Align.Center
            Text: ="<1 mês"
            Visible: =Trim(Lower('Passos do Registo de Atividade_1'.Selected.titulo)) = Trim(Lower("Fatores de Criticidade"))
            Width: =110
            X: =984
            Y: =160
            ZIndex: =25

    Label3_18 As label:
        Align: =Align.Center
        Text: ="Racional"
        Visible: =Trim(Lower('Passos do Registo de Atividade_1'.Selected.titulo)) = Trim(Lower("Fatores de Criticidade"))
        Width: =110
        X: =1176
        Y: =160
        ZIndex: =52

